{"version":3,"sources":["webpack://@spiral-toolkit/form/webpack/universalModuleDefinition","webpack://@spiral-toolkit/form/webpack/bootstrap","webpack://@spiral-toolkit/form/external \"@spiral-toolkit/core\"","webpack://@spiral-toolkit/form/./src/formToObject.js","webpack://@spiral-toolkit/form/./src/index.js","webpack://@spiral-toolkit/form/./src/Form.js","webpack://@spiral-toolkit/form/./src/formMessages.js","webpack://@spiral-toolkit/form/./src/iterateInputs.js"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__0__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","FormToObject","formRef","this","keyRegex","$form","$formElements","formObj","setForm","setFormElements","setFormObj","document","getElementById","isDomNode","querySelectorAll","length","node","nodeType","forEach","arr","callback","addChild","result","domNode","keys","nodeName","type","checked","push","DOMchilds","child","splice","test","disabled","match","sf","Form","default","registerInstanceType","formMessages","iterateInputs","options","_construct","createModulePrototype","init","mixMessagesOptions","DOMEvents","helpers","addEvents","events","core","Events","optionsToGrab","processor","val","domAttr","self","JSON","parse","e","console","error","assign","toLowerCase","global","instances","form","messages","defaults","messagesType","onSubmit","getInstance","preventDefault","stopPropagation","removeMessages","data","getFormData","FormData","context","useAjax","trigger","send","lock","remove","lockType","removeInstance","warn","addInstance","showFormMessage","showFieldMessage","showFieldsMessages","showMessages","removeMessage","processAnswer","answer","sendOptions","that","beforeSubmitCallback","fn","eval","ajax","then","log","setOptions","opt","add","DOMNode","eventType","eventFunction","die","removeAll","template","close","place","levels","success","info","warning","field","fieldTemplate","fieldClose","fieldPlace","fieldPrefix","prepareMessageObject","message","toString","text","debug","notice","danger","critical","alert","emergency","isMsg","errors","warnings","status","statusText","_messages","closeHandler","addEventListener","removeEventListener","el","parentNode","removeChild","classList","indexOf","msgEl","tpl","parser","DOMParser","item","replace","parseFromString","firstChild","lastChild","appendChild","insertBefore","querySelector","isContainer","domTools","closest","msgObj","container","notFound","names","prefix","findNodes","partOfSelector","selector","sel","nodes","max","obj"],"mappings":"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","file":"form.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@spiral-toolkit/core\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"@spiral-toolkit/form\", [\"@spiral-toolkit/core\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"@spiral-toolkit/form\"] = factory(require(\"@spiral-toolkit/core\"));\n\telse\n\t\troot[\"@spiral-toolkit/form\"] = factory(root[\"@spiral-toolkit/core\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","/* github.com/serbanghita/FormToObject.js 1.0.1  (c) 2013 Serban Ghita <serbanghita@gmail.com> @licence MIT */\n// Constructor.\n\nvar FormToObject = function (formRef) {\n    if (!formRef) {\n        return false;\n    }\n\n    this.formRef = formRef;\n    this.keyRegex = /[^\\[\\]]+/g;\n    this.$form = null;\n    this.$formElements = [];\n    this.formObj = {};\n\n    if (!this.setForm()) {\n        return false;\n    }\n    if (!this.setFormElements()) {\n        return false;\n    }\n\n    return this.setFormObj();\n};\n\n// Set the main form object we are working on.\nFormToObject.prototype.setForm = function () {\n    switch (typeof this.formRef) {\n\n        case 'string':\n            this.$form = document.getElementById(this.formRef);\n            break;\n\n        case 'object':\n            if (this.isDomNode(this.formRef)) {\n                this.$form = this.formRef;\n            }\n            break;\n\n    }\n\n    return this.$form;\n};\n\n// Set the elements we need to parse.\nFormToObject.prototype.setFormElements = function () {\n    this.$formElements = this.$form.querySelectorAll('input, textarea, select');\n    return this.$formElements.length;\n};\n\n// Check to see if the object is a HTML node.\nFormToObject.prototype.isDomNode = function (node) {\n    return typeof node === \"object\" && \"nodeType\" in node && node.nodeType === 1;\n};\n\n// Iteration through arrays and objects. Compatible with IE.\nFormToObject.prototype.forEach = function (arr, callback) {\n    if ([].forEach) {\n        return [].forEach.call(arr, callback);\n    }\n\n    var i;\n    for (i in arr) {\n        // Object.prototype.hasOwnProperty instead of arr.hasOwnProperty for IE8 compatibility.\n        if (Object.prototype.hasOwnProperty.call(arr, i)) {\n            callback.call(arr, arr[i]);\n        }\n    }\n};\n\n// Recursive method that adds keys and values of the corresponding fields.\nFormToObject.prototype.addChild = function (result, domNode, keys, value) {\n    // #1 - Single dimensional array.\n    if (keys.length === 1) {\n        // We're only interested in the radio that is checked.\n        if (domNode.nodeName === 'INPUT' && domNode.type === 'radio') {\n            if (domNode.checked) {\n                return result[keys] = value;\n            } else {\n                return;\n            }\n        }\n\n        // Checkboxes are a special case. We have to grab each checked values\n        // and put them into an array.\n        if (domNode.nodeName === 'INPUT' && domNode.type === 'checkbox') {\n            if (domNode.checked) {\n                if (!result[keys]) {\n                    result[keys] = [];\n                }\n                return result[keys].push(value);\n            } else {\n                return;\n            }\n        }\n\n        // Multiple select is a special case.\n        // We have to grab each selected option and put them into an array.\n        if (domNode.nodeName === 'SELECT' && domNode.type === 'select-multiple') {\n            result[keys] = [];\n            var DOMchilds = domNode.querySelectorAll('option[selected]');\n            if (DOMchilds) {\n                this.forEach(DOMchilds, function (child) {\n                    result[keys].push(child.value);\n                });\n            }\n            return;\n        }\n\n        // Fallback. The default one to one assign.\n        result[keys] = value;\n    }\n\n    // #2 - Multi dimensional array.\n    if (keys.length > 1) {\n        if (!result[keys[0]]) {\n            result[keys[0]] = {};\n        }\n\n        return this.addChild(result[keys[0]], domNode, keys.splice(1, keys.length), value);\n    }\n\n    return result;\n};\n\nFormToObject.prototype.setFormObj = function () {\n    var test;\n    var i = 0;\n\n    for (i = 0; i < this.$formElements.length; i++) {\n        // Ignore the element if the 'name' attribute is empty.\n        // Ignore the 'disabled' elements.\n        if (this.$formElements[i].name && !this.$formElements[i].disabled) {\n            test = this.$formElements[i].name.match(this.keyRegex);\n            this.addChild(this.formObj, this.$formElements[i], test, this.$formElements[i].value);\n        }\n    }\n\n    return this.formObj;\n};\n\nmodule.exports = FormToObject;\n","\"use strict\";\nvar sf = require('@spiral-toolkit/core');\nvar Form = require('./Form').default;\n\nsf.registerInstanceType(Form, \"js-sf-form\");\n\nmodule.exports = Form; // ES6 default export will not expose us as global\n","\"use strict\";\n\nimport sf from '@spiral-toolkit/core';\n\nvar formMessages = require(\"./formMessages\");\nvar iterateInputs = require(\"./iterateInputs\");\nimport FormToObject from './formToObject';\n\n/**\n * Spiral Forms\n * @param {Object} sf\n * @param {Object} node  DomNode of form\n * @param {Object} [options] all options to override default\n * @constructor Form\n * @extends BaseDOMConstructor\n */\nvar Form = function (sf, node, options) {\n    this._construct(sf, node, options);\n};\n\n\n/**\n * @lends sf.Form.prototype\n */\nForm.prototype = sf.createModulePrototype();\n\n/**\n * Name to register\n * @type {string}\n */\nForm.prototype.name = \"form\";\n\n/**\n * Function that call on new instance is created.\n * @param {Object} sf\n * @param {Object} node  DomNode of form\n * @param {Object} [options] all options to override default\n * @private\n */\nForm.prototype._construct = function (sf, node, options) {\n    this.init(sf, node, options);\n    this.mixMessagesOptions();\n    // this.options.fillFrom && this.fillFieldsFrom(); // id required to fill form\n\n    /**\n     * @extends DOMEvents\n     * @type {DOMEvents}\n     * @inheritDoc\n     * */\n    this.DOMEvents = new this.sf.helpers.DOMEvents();\n    this.addEvents();\n\n    this.events = new this.sf.core.Events([\"beforeSend\", \"success\", \"error\", \"always\"]);\n    sf.iterateInputs = iterateInputs;\n};\n\n/**\n * @override\n * @inheritDoc\n * @enum {Object}\n * @deprecated\n */\nForm.prototype.optionsToGrab = {\n    /**\n     * Link to form\n     */\n    \"context\": {\n        processor: function (node, val) { // Processor\n            return node;\n        }\n    },\n    /**\n     * Link to 'this'\n     */\n    \"self\": {\n        processor: function (node, val) {\n            return this;\n        }\n    },\n    /**\n     * URL to send form (if ajax form) <b>Default: \"/\"</b>\n     */\n    \"url\": {\n        domAttr: \"action\",\n        value: \"/\"\n    },\n    /**\n     * Method to send to send form (if ajax form) <b>Default: \"POST\"</b>\n     */\n    \"method\": {\n        domAttr: \"method\",\n        value: \"POST\"\n    },\n    /**\n     * Lock type when form sending <b>Default: \"default\"</b> @see sf.lock\n     */\n    \"lockType\": {\n        value: \"default\",\n        domAttr: \"data-lockType\"\n    },\n    /**\n     *\n     */\n    \"messagesType\": {\n        value: \"spiral\",\n        domAttr: \"data-messagesType\"\n    },\n    /**\n     * Pass custom template for form messages\n     */\n    \"messages\": {\n        value: \"\",\n        domAttr: \"data-messages\",\n        processor: function (node, val, self) {\n            if (!val) return this.value;\n            if (typeof val == \"string\") {\n                try {\n                    val = JSON.parse(val);\n                } catch (e) {\n                    console.error(\"Form JSON.parse error: \", e);\n                }\n            }\n            return Object.assign(self.value, val);\n        }\n    },\n    /**\n     * Use ajax to submit form <b>Default: true</b>\n     */\n    \"useAjax\": { // Attribute of form\n        value: true, // Default value\n        domAttr: \"data-useAjax\",\n        processor: function (node, val) { // processor to process data before return\n            if (typeof val === \"boolean\") {\n                return val;\n            }\n            val = (val !== void 0 && val !== null) ? val.toLowerCase() : '';\n            if (val === 'false') {\n                val = false;\n            } else if (val === 'true') {\n                val = true;\n            }\n            return val;\n        }\n    },\n    /**\n     * Callback after form submitting <b>Default: false</b>\n     * <br/>\n     * <b> Example </b>\n     * function(options){\n     *  //options contains all options after send\n     * }\n     */\n    \"ajaxCallback\": { // attribute of form\n        value: false, // Default value\n        domAttr: \"data-callback\"\n    },\n    \"beforeSubmitCallback\": {// attribute of form\n        value: false, // Default value\n        domAttr: \"data-before-submit\"\n    },\n    \"afterSubmitCallback\": {// attribute of form\n        value: false, // Default value\n        domAttr: \"data-after-submit\"\n    },\n    \"headers\": {// attribute of form\n        value: {\"Accept\": \"application/json\"}, // Default value\n        domAttr: \"data-headers\",\n        processor: function (node, val, self) {\n            if (val === void 0 || val == null) return this.value;\n            if (typeof val == \"string\") {\n                try {\n                    val = JSON.parse(val);\n                } catch (e) {\n                    console.error(\"Form JSON.parse error: \", e);\n                }\n            }\n            return Object.assign(self.value, val);\n        }\n    }\n};\n\nForm.prototype.mixMessagesOptions = function () {\n    var global = this.sf.options.instances.form;\n    this.options.messages = Object.assign({},\n        formMessages.defaults,\n        global && global.messages && global.messages[this.options.messagesType],\n        this.options.messages\n    );\n};\n\n/**\n * Call on form submit\n * @param {Event} e submit event\n */\nForm.prototype.onSubmit = function (e) {\n    if (this.sf.getInstance('lock', this.node)) {\n        // On lock we should'n do any actions\n        e.preventDefault();\n        e.stopPropagation();\n        return;\n    }\n\n    this.removeMessages();\n\n    this.options.data = this.getFormData();\n\n    // We can send files only with FormData\n    // If form contain files and no FormData than disable ajax\n    if (!window.FormData && this.options.context.querySelectorAll(\"input[type='file']\").length !== 0) {\n        this.options.useAjax = false;\n    }\n    this.events.trigger(\"beforeSend\", this.options);\n    // sf.events.performAction(\"beforeSubmit\", this.options);\n    // this.events.performAction(\"beforeSubmit\", this.options);\n\n    if (this.options.useAjax) {\n        this.send(this.options);\n\n        e.preventDefault();\n        e.stopPropagation();\n    }\n};\n\n/**\n * Locker. Add or remove.\n * @param {Boolean} [remove]\n */\nForm.prototype.lock = function (remove) {\n    if (!this.options.lockType || this.options.lockType === 'none') {\n        return;\n    }\n    if (remove) {\n        if (!this.sf.removeInstance(\"lock\", this.node)) {\n            console.warn(\"You try to remove 'lock' instance, but it is not available or not started\");\n        }\n    } else {\n        if (!this.sf.addInstance(\"lock\", this.node, {type: this.options.lockType})) {\n            console.warn(\"You try to add 'lock' instance, but it is not available or already started\");\n        }\n    }\n};\n\n// Form messages\nForm.prototype.showFormMessage = formMessages.showFormMessage;\nForm.prototype.showFieldMessage = formMessages.showFieldMessage;\nForm.prototype.showFieldsMessages = formMessages.showFieldsMessages;\nForm.prototype.showMessages = formMessages.showMessages;\nForm.prototype.removeMessages = formMessages.removeMessages;\nForm.prototype.removeMessage = formMessages.removeMessage;\n\nForm.prototype.processAnswer = function (answer) {\n    this.options.messagesType && this.showMessages(answer);\n};\n\n/**\n * Send form to server\n * @param {Object} sendOptions\n */\nForm.prototype.send = function (sendOptions) {\n    var that = this;\n    this.lock();\n    if (sendOptions.beforeSubmitCallback) {\n        var fn = eval(sendOptions.beforeSubmitCallback);\n        if (typeof(fn) === \"function\") {\n            fn.call(sendOptions);\n        }\n    }\n    this.sf.ajax.send(sendOptions).then(\n        function (answer) {\n            that.events.trigger(\"success\", sendOptions);\n            return answer;\n        },\n        function (error) {\n            that.events.trigger(\"error\", sendOptions);\n            return error;\n        }).then(function (answer) {\n        that.lock(true);\n        that.processAnswer(answer);\n        that.events.trigger(\"always\", sendOptions);\n    });\n};\n\n/**\n * Serialize form\n * @return {Object}\n */\nForm.prototype.getFormData = function () {\n    if (!!window.FormData) {\n        return new FormData(this.options.context);\n    } else {\n        console.log(\"Form `\" + this.options.context + \"` were processed without FormData.\");\n        return new FormToObject(this.options.context);\n    }\n};\n\n/**\n * Set options (overwrite current)\n * @param {Object} opt options\n */\nForm.prototype.setOptions = function (opt) {\n    this.options = Object.assign(this.options, opt);\n};\n\n/**\n * Add all events for forms\n */\nForm.prototype.addEvents = function () {\n    var that = this;\n    this.DOMEvents.add([\n        {\n            DOMNode: this.options.context,\n            eventType: \"submit\",\n            eventFunction: function (e) {\n                that.onSubmit.call(that, e);\n            }\n        }\n    ]);\n};\n\n/**\n * Clear all variables and die\n */\nForm.prototype.die = function () {\n    this.DOMEvents.removeAll();\n    // TODO don't we need to remove it's addons and plugins?\n};\n\nexport default Form;\n","\"use strict\";\n\nvar defaults = {\n    template: '<div class=\"alert form-msg ${type}\"><button class=\"btn-close\">Ã—</button><p class=\"msg\">${text}</p></div>',\n    close: '.btn-close',\n    place: 'bottom',\n    levels: {\n        success: \"success\", info: \"info\", warning: \"warning\", error: \"error\"\n    },\n    field: '.item-form',\n    fieldTemplate: '<div class=\"alert form-msg ${type}\"><p class=\"msg\">${text}</p></div>',\n    fieldClose: '.btn-close',\n    fieldPlace: 'bottom',\n    fieldPrefix: '' // For bootstrap: class=\"has-danger\"\n};\n\n// Often used alias\ndefaults.levels.message = defaults.levels.success;\n\n// Other aliases\n// PSR-3 severity levels mapping (debug, info, notice, warning, error, critical, alert, emergency)\n// https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-3-logger-interface.md\ndefaults.levels.debug = defaults.levels.success;\ndefaults.levels.info = defaults.levels.notice = defaults.levels.info;\ndefaults.levels.danger = defaults.levels.critical = defaults.levels.alert = defaults.levels.emergency = defaults.levels.error;\n\n/**\n * @param {Object|String} message\n * @param {String} type\n * @return {Object}\n */\nfunction prepareMessageObject(message, type) {\n    if (Object.prototype.toString.call(message) !== \"[object Object]\") {\n        message = {text: message, type: type};\n    }\n    message.text = message.text || message.message || message;\n    message.type = message.type || type;\n    return message;\n}\n\nmodule.exports = {\n    defaults: defaults,\n    showMessages: function (answer) {\n        if (!answer) return;\n\n        var isMsg = false;\n        var that = this;\n\n        for (var type in this.options.messages.levels) {\n            if (answer[type]) {\n                this.showFormMessage(answer[type], this.options.messages.levels[type]);\n                isMsg = true;\n            }\n        }\n\n        if (answer.messages) {\n            this.showFieldsMessages(answer.messages, \"success\");\n            isMsg = true;\n        }\n        if (answer.errors) {\n            this.showFieldsMessages(answer.errors, \"error\");\n            isMsg = true;\n        }\n        if (answer.warnings) {\n            this.showFieldsMessages(answer.warnings, \"warning\");\n            isMsg = true;\n        }\n\n        if (!isMsg && answer.status > 300) {\n            var error = answer.status ? answer.status + \" \" : \"\";\n            error += answer.statusText ? answer.statusText : \"\";\n            error += answer.data && !answer.statusText ? answer.data : \"\";\n            error += error.length === 0 ? answer : \"\";\n            this.showFormMessage(error, \"error\");\n        }\n\n        this._messages.forEach(function (m) {\n            if (m.close) {\n                m.closeHandler = that.removeMessage.bind(that, m);\n                m.close.addEventListener(\"click\", m.closeHandler);\n            }\n        });\n    },\n    removeMessage: function (m, e) {\n        m.close && m.close.removeEventListener(\"click\", m.closeHandler);\n        m.el.parentNode.removeChild(m.el);\n        m.field && m.field.classList.remove(this.options.messages.fieldPrefix + m.type);\n        if (e) {\n            e.preventDefault && e.preventDefault();\n            this._messages.splice(this._messages.indexOf(m), 1);\n        }\n    },\n    removeMessages: function () {\n        var that = this;\n        if (this._messages) {\n            this._messages.forEach(function (m) {\n                that.removeMessage(m, false);\n            });\n        }\n        that._messages = [];\n    },\n    showFormMessage: function (message, type) {\n        var msgEl;\n        var parent;\n        var tpl = this.options.messages.template;\n        var parser = new DOMParser();\n\n        message = prepareMessageObject(message, type);\n\n        for (var item in message) {\n            if (!message.hasOwnProperty(item)) return;\n            tpl = tpl.replace('${' + item + '}', message[item]);\n        }\n\n        msgEl = parser.parseFromString(tpl, \"text/html\").firstChild.lastChild.firstChild;\n\n        if (this.options.messages.place === \"bottom\") {\n            this.node.appendChild(msgEl);\n        } else if (this.options.messages.place === \"top\") {\n            this.node.insertBefore(msgEl, this.node.firstChild);\n        } else {\n            parent = document.querySelector(this.options.messages.place);\n            parent.appendChild(msgEl);\n        }\n        this._messages.push({el: msgEl, close: msgEl.querySelector(this.options.messages.close)});\n    },\n    /**\n     * @param {HTMLElement} el\n     * @param {String} message\n     * @param {String} type\n     * @param {Boolean} [isContainer]\n     */\n    showFieldMessage: function (el, message, type, isContainer) {\n        var field = isContainer ? el : sf.helpers.domTools.closest(el, this.options.messages.field);\n        var msgEl;\n        var tpl = this.options.messages.fieldTemplate;\n\n        if (!field) return;\n\n        var parser = new DOMParser();\n        message = prepareMessageObject(message, type);\n\n        field.classList.add(this.options.messages.fieldPrefix + type);\n\n        for (var item in message) {\n            if (!message.hasOwnProperty(item)) return;\n            tpl = tpl.replace('${' + item + '}', message[item]);\n        }\n\n        msgEl = parser.parseFromString(tpl, \"text/html\").firstChild.lastChild.firstChild;\n\n        if (this.options.messages.fieldPlace === \"bottom\") {\n            field.appendChild(msgEl);\n        } else if (this.options.messages.fieldPlace === \"top\") {\n            field.insertBefore(msgEl, field.firstChild);\n        } else {\n            field = field.querySelector(this.options.messages.fieldPlace);\n            field.appendChild(msgEl);\n        }\n\n        this._messages.push({\n            el: msgEl,\n            close: msgEl.querySelector(this.options.messages.fieldClose),\n            field: field,\n            type: type\n        });\n    },\n    showFieldsMessages: function (messages, type) {\n        var that = this;\n        var notFound = sf.iterateInputs(this.node, messages, function (el, message) {\n            that.showFieldMessage(el, message, type);\n        });\n\n        notFound.forEach(function (msgObj) {\n            Object.keys(msgObj).forEach(function (name) {\n                var container = that.node.querySelector('[data-message-placeholder=\"' + name + '\"]');\n                if (container) {\n                    // TODO check container.dataset.messageVariant? variants are \"field\" and \"form\"\n                    that.showFieldMessage(container, msgObj[name], type, true);\n                }\n            });\n        });\n    }\n};\n","\"use strict\";\n// Plugin in formMessages to iterate form inputs\n\n// TODO comment all of this\n// TODO ask @Systerr the reason of variable 'prefix'\nvar notFound = [];\n\n/**\n *\n * @param {HTMLElement} context\n * @param {Object} names\n * @param {Function} callback\n * @param {String} [prefix]\n */\nfunction findNodes(context, names, callback, prefix) {\n    for (var name in names) {\n        if (!names.hasOwnProperty(name)) {\n            continue;\n        }\n\n        var partOfSelector = (prefix) ? prefix + \"[\" + name + \"]\" : name;\n        var type = Object.prototype.toString.call(names[name]);\n        var selector = \"[name='\" + partOfSelector + \"']\";\n\n        switch (type) {\n            case '[object Object]':\n                findNodes(context, names[name], callback, partOfSelector);\n                break;\n            case '[object Array]':\n                names[name].forEach(function (el) {\n                    \"use strict\";\n                    // TODO refactor this should call recursive\n                    var sel = \"[name='\" + partOfSelector + \"[]']\" + \"[value='\" + el + \"']\";\n                    var nodes = context.querySelectorAll(sel);\n                    if (nodes.length === 0) {\n                        notFound.push(sel);\n                    }\n                    for (var i = 0, max = nodes.length; i < max; i++) {\n                        callback(nodes[i], true);\n                    }\n                });\n                break;\n            case '[object String]':\n            case '[object Number]':\n                var nodes = context.querySelectorAll(selector);\n                if (nodes.length === 0) {\n                    var obj = {};\n                    obj[partOfSelector] = names[name];\n                    notFound.push(obj);\n                }\n                for (var i = 0, max = nodes.length; i < max; i++) {\n                    callback(nodes[i], names[name]);\n                }\n                break;\n\n            default :\n                console.error(\"unknown type -\", type, \" and message\", names[name]);\n        }\n    }\n}\n\n/**\n * @param {HTMLElement} context\n * @param {Object} names\n * @param {Function} callback\n * @param {String} [prefix]\n * @return {String[]}\n */\nvar iterateInputs = function (context, names, callback, prefix) {\n    notFound = [];\n    findNodes(context, names, callback, prefix);\n    if (notFound.length !== 0) {\n        console.log(\"Some element not found in form\", notFound);\n    }\n    return notFound;\n};\n\nmodule.exports = iterateInputs;\n"],"sourceRoot":""}