{"version":3,"sources":["webpack://SFToolkit/webpack/universalModuleDefinition","webpack://SFToolkit/webpack/bootstrap","webpack://SFToolkit/./src/input/index.js","webpack://SFToolkit/./src/input/input.js","webpack://SFToolkit/SFDataGrid/webpack/universalModuleDefinition","webpack://SFToolkit/SFDataGrid/webpack/bootstrap","webpack://SFToolkit/webpack:/SFDataGrid/external \"@spiral-toolkit/core\"","webpack://SFToolkit/SFDataGrid/O:/Projects/SF/toolkit/node_modules/node-libs-browser/node_modules/assert/assert.js","webpack://SFToolkit/SFDataGrid/O:/Projects/SF/toolkit/node_modules/query-string/index.js","webpack://SFToolkit/SFDataGrid/(webpack)/buildin/global.js","webpack://SFToolkit/SFDataGrid/O:/Projects/SF/toolkit/node_modules/object-assign/index.js","webpack://SFToolkit/SFDataGrid/O:/Projects/SF/toolkit/node_modules/util/util.js","webpack://SFToolkit/SFDataGrid/O:/Projects/SF/toolkit/node_modules/process/browser.js","webpack://SFToolkit/SFDataGrid/O:/Projects/SF/toolkit/node_modules/util/support/isBufferBrowser.js","webpack://SFToolkit/SFDataGrid/O:/Projects/SF/toolkit/node_modules/util/node_modules/inherits/inherits_browser.js","webpack://SFToolkit/SFDataGrid/O:/Projects/SF/toolkit/node_modules/strict-uri-encode/index.js","webpack://SFToolkit/SFDataGrid/O:/Projects/SF/toolkit/node_modules/decode-uri-component/index.js","webpack://SFToolkit/SFDataGrid/O:/Projects/SF/toolkit/node_modules/split-on-first/index.js","webpack://SFToolkit/SFDataGrid/src/constants.ts","webpack://SFToolkit/SFDataGrid/src/DatagridState.ts","webpack://SFToolkit/SFDataGrid/src/Paginator.ts","webpack://SFToolkit/SFDataGrid/src/render/defaultRenderer.ts","webpack://SFToolkit/SFDataGrid/src/utils.ts","webpack://SFToolkit/SFDataGrid/src/render/defaultBodyWrapper.ts","webpack://SFToolkit/SFDataGrid/src/render/defaultFooterWrapper.ts","webpack://SFToolkit/SFDataGrid/src/render/defaultHeaderCellRenderer.ts","webpack://SFToolkit/SFDataGrid/src/render/defaultHeaderWrapper.ts","webpack://SFToolkit/SFDataGrid/src/render/defaultRowRenderer.ts","webpack://SFToolkit/SFDataGrid/src/render/defaultRowWrapper.ts","webpack://SFToolkit/SFDataGrid/src/render/defaultTableWrapper.ts","webpack://SFToolkit/SFDataGrid/src/render/GridRenderer.ts","webpack://SFToolkit/SFDataGrid/src/Datagrid.ts","webpack://SFToolkit/SFDataGrid/src/render/premade/simpleCellFormatter.ts","webpack://SFToolkit/SFDataGrid/src/index.ts","webpack://SFToolkit/./src/index.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","sf","require","Input","default","instancesController","registerInstanceType","node","options","this","_construct","core","BaseDOMConstructor","init","tools","extend","els","prefix","setPrefix","addPrefixEventListeners","pattern","setupPattern","addPatternEventListeners","optionsToGrab","domAttr","isValidPattern","match","that","_inputKeyPress","event","char","String","fromCharCode","keyCode","position","getCursorPosition","length","preventDefault","offset","formatCharacters","indexOf","futureValue","substring","patternWithEmpty","setCursorPosition","addEventListener","_inputFocus","setTimeout","patternString","replace","_inputKeyDown","console","log","_inputBlur","document","selection","focus","selectRange","createRange","moveStart","text","selectionStart","createTextRange","range","move","select","selectionEnd","getAttribute","placeholder","formattedPatternStr","formattedPatternWithEmptyStr","RegExp","_initPattern","_inputKeyup","oldValue","removePatternEventListeners","removePrefixEventListeners","removeEventListener","die","__WEBPACK_EXTERNAL_MODULE__0__","objectAssign","compare","a","b","x","y","len","Math","min","isBuffer","global","Buffer","_isBuffer","util","hasOwn","pSlice","Array","slice","functionsHaveNames","pToString","obj","toString","isView","arrbuf","ArrayBuffer","DataView","buffer","assert","ok","regex","getName","func","isFunction","truncate","inspect","something","rawname","fail","actual","expected","message","operator","stackStartFunction","AssertionError","_deepEqual","strict","memos","isDate","getTime","isRegExp","source","multiline","lastIndex","ignoreCase","Float32Array","Float64Array","Uint8Array","actualIndex","push","actualVisitedObjects","isPrimitive","getPrototypeOf","aIsArgs","isArguments","bIsArgs","ka","objectKeys","kb","sort","expectedException","test","e","Error","isPrototypeOf","_throws","shouldThrow","block","TypeError","error","userProvidedMessage","isUnexpectedException","isError","generatedMessage","captureStackTrace","err","stack","out","fn_name","idx","next_line","inherits","equal","notEqual","deepEqual","deepStrictEqual","notDeepEqual","notDeepStrictEqual","strictEqual","notStrictEqual","throws","doesNotThrow","ifError","keys","strictUriEncode","decodeComponent","splitOnFirst","validateArrayFormatSeparator","encode","encodeURIComponent","decode","removeHash","input","hashStart","extract","queryStart","parseValue","parseNumbers","Number","isNaN","trim","parseBooleans","toLowerCase","parse","assign","arrayFormat","arrayFormatSeparator","formatter","result","accumulator","exec","concat","newValue","split","map","item","ret","param","k","reduce","Boolean","isArray","keysSorter","stringify","shouldFilter","skipNull","skipEmptyString","index","join","objectCopy","filter","parseUrl","url","query","stringifyUrl","queryFromUrl","parsedQueryFromUrl","hash","queryString","g","Function","getOwnPropertySymbols","propIsEnumerable","propertyIsEnumerable","toObject","val","test1","getOwnPropertyNames","test2","test3","forEach","letter","target","from","symbols","to","arguments","getOwnPropertyDescriptors","descriptors","getOwnPropertyDescriptor","formatRegExp","format","f","isString","objects","args","str","JSON","_","isNull","isObject","deprecate","fn","msg","process","noDeprecation","apply","warned","throwDeprecation","traceDeprecation","trace","debugEnviron","debugs","opts","ctx","seen","stylize","stylizeNoColor","depth","colors","isBoolean","showHidden","_extend","isUndefined","customInspect","stylizeWithColor","formatValue","styleType","style","styles","recurseTimes","constructor","primitive","simple","isNumber","visibleKeys","array","formatError","Date","output","base","braces","toUTCString","formatProperty","pop","prev","cur","desc","set","line","substr","ar","arg","re","objectToString","pad","debuglog","env","NODE_DEBUG","toUpperCase","pid","isNullOrUndefined","isSymbol","months","timestamp","time","getHours","getMinutes","getSeconds","getDate","getMonth","prop","origin","add","kCustomPromisifiedSymbol","callbackifyOnRejected","reason","cb","newReason","promisify","original","writable","configurable","promiseResolve","promiseReject","promise","Promise","resolve","reject","setPrototypeOf","defineProperties","custom","callbackify","callbackified","maybeCb","self","then","nextTick","rej","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","drainQueue","timeout","run","marker","Item","noop","title","browser","argv","version","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","copy","fill","readUInt8","ctor","superCtor","super_","TempCtor","charCodeAt","singleMatcher","multiMatcher","decodeComponents","components","decodeURIComponent","left","right","tokens","encodedURI","replaceMap","entries","string","separator","separatorIndex","SortDirection","RequestMethod","pageParams","sortParams","parent","state","loading","paginator","page","limit","sortDir","ASC","data","formData","urlData","params","sortBy","pagination","errors","updatePaginator","resetData","field","direction","formId","forms","PaginatorType","super","id","defaultOptions","type","fetchCount","fetchCountOnce","fetching","render","lockType","removeInstance","warn","addInstance","count","limitOptions","pagesCount","hasTotal","ceil","hasNext","hasPrevious","currentRange","max","startRange","extendCurrent","endRange","pages","active","onPageChange","counterDiv","createElement","className","hasPages","innerHTML","limitDiv","hasLimitOptions","querySelector","opt","option","setAttribute","appendChild","setLimit","pagesDiv","ul","pageInfo","generatePageList","li","setPage","el","spiralFrameworkName","normalizeColumns","columns","sortable","sList","find","applyAttrributes","attrs","defaultBodyWrapper","hasError","errorTr","errorTd","colSpan","innerText","errorMessage","classList","emptyTr","emptyTd","defaultFooterWrapper","defaultHeaderCellRenderer","column","classes","triggerSort","defaultHeaderWrapper","tr","defaultRowCellRenderer","defaultRowWrapper","defaultTableWrapper","ui","tableClassName","columnInfo","wrapper","wrapperClassName","tableRenderer","tableWrapper","tableEl","cellMeta","rowSelected","cellClassName","specific","cellAttributes","headerCellClassName","headerCellAttributes","headerRenderer","headerWrapper","headerEl","removeChild","cI","headerList","applyAdditionalHeaderCellAttributes","bodyEl","bodyRenderer","bodyWrapper","row","rowWrapper","cells","applyAdditionalCellAttributes","footerEl","footerRenderer","footerWrapper","grids","capturedForms","capturedPaginators","defaults","additionalOptionsEl","overrides","setSort","createRenderers","initFromUrl","captureForms","request","formInstance","jsonOnly","beforeSubmitCallback","resetPaginator","setFormData","getInstances","registerFormInstance","instance","events","registerPaginatorInstance","fieldId","DESC","setParams","paginate","getFilter","unlock","lock","setSuccess","removeMessages","status","statusText","setError","resetOnError","processAnswer","thisArg","_arguments","P","generator","fulfilled","step","next","rejected","done","__awaiter","isLoading","startLoading","beforeSubmit","updateUrl","formRequest","ajax","send","method","headers","response","handleSuccess","isSFAjaxError","handleError","originalError","stopLoading","renderers","renderOption","grid","sortOptions","values","cid","lid","serialize","location","search","getObjectFromUrl","deserialize","putObjectToUrl","oK","history","pushState","href","POST","rowAttributes","rowClassName","rowlMeta","renders","simpleCellFormatter","formatFunction","v","tagName","SFDatagridTools"],"mappings":"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","file":"toolkit.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"@spiral-toolkit/toolkit\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"@spiral-toolkit/toolkit\"] = factory();\n\telse\n\t\troot[\"SFToolkit\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 15);\n","\nconst sf = require('@spiral-toolkit/core');\nconst Input = require('./input').default;\n\nsf.instancesController.registerInstanceType(Input, 'sf-js-input');\nmodule.exports = Input; // ES6 default export will not expose us as global\n","/* eslint-disable no-console */\n/* eslint-disable max-len */\n/* eslint-disable no-underscore-dangle */\n/* eslint-disable func-names */\n\nimport core from '@spiral-toolkit/core';\n\nconst Input = function (sf, node, options) {\n  this._construct(sf, node, options);\n};\n\n/**\n * @lends sf.Form.prototype\n */\nInput.prototype = Object.create(core.core.BaseDOMConstructor.prototype);\n\n/**\n * Name to register\n * @type {string}\n */\nInput.prototype.name = 'input';\n\nInput.prototype._construct = function (sf, node, options) {\n  this.init(sf, node, options); // call parent\n\n  if (options) {\n    // if we pass options extend all options by passed options\n    this.options = sf.tools.extend(this.options, options);\n  }\n\n  // Elements\n  this.els = {\n    node,\n  };\n\n  if (this.options.prefix) {\n    this.setPrefix();\n    this.addPrefixEventListeners();\n  } else if (this.options.pattern) {\n    this.setupPattern();\n    this.addPatternEventListeners();\n  }\n};\n\n\n/**\n * @override\n * @inheritDoc\n * @enum {string}\n */\nInput.prototype.optionsToGrab = {\n  /**\n     *  Pattern of input\n     */\n  pattern: {\n    domAttr: 'data-pattern',\n  },\n  /**\n     *  Prefix of  input\n     */\n  prefix: {\n    domAttr: 'data-prefix',\n  },\n};\n\n/**\n * Setup pattern\n * @return {HTMLElement}\n */\nInput.prototype.isValidPattern = function () {\n  return this.els.node.value.match(this.pattern);\n};\n\nInput.prototype.addPatternEventListeners = function () {\n  const that = this;\n\n  this._inputKeyPress = function (event) {\n    const char = String.fromCharCode(event.keyCode);\n    const { value } = that.els.node;\n    const position = that.getCursorPosition();\n\n    if (char.length > 0) {\n      event.preventDefault();\n      let offset = 1;\n      for (let i = position; i < value.length; i += 1) {\n        if (that.formatCharacters.indexOf(value[i]) !== -1) {\n          offset += 1;\n        } else {\n          break;\n        }\n      }\n\n      const futureValue = value.substring(0, position + offset - 1) + char + value.substring(position + offset, value.length);\n\n      if (!futureValue.match(that.patternWithEmpty)) {\n        return false;\n      }\n      that.els.node.value = futureValue;\n      that.setCursorPosition(position + offset);\n      return false;\n    }\n    return true;\n  };\n\n  this.els.node.addEventListener('keypress', this._inputKeyPress);\n\n  this._inputFocus = function (event) {\n    event.preventDefault();\n\n    setTimeout(() => {\n      if (that.els.node.value === '') {\n        // eslint-disable-next-line no-useless-escape\n        that.els.node.value = that.patternString.replace(/[^\\-\\(\\)\\[\\]\\:\\.\\,\\$\\%\\@\\ \\/]/g, '_');\n        that.setCursorPosition(0);\n      }\n    }, 0);\n  };\n  this.els.node.addEventListener('focus', this._inputFocus);\n\n  this._inputKeyDown = function (event) {\n    const char = String.fromCharCode(event.keyCode);\n    const { value } = that.els.node;\n    const position = that.getCursorPosition();\n\n    if (event.keyCode === 8 || event.keyCode === 46) {\n      event.preventDefault();\n      let offset = 0;\n      for (let i = position - 1; i > 0; i -= 1) {\n        if (that.formatCharacters.indexOf(value[i]) !== -1) {\n          offset -= 1;\n        } else {\n          break;\n        }\n      }\n\n      const futureValue = `${value.substring(0, position + offset - 1)}_${value.substring(position + offset, value.length)}`;\n\n      if (!futureValue.match(that.patternWithEmpty)) {\n        return false;\n      }\n      console.log(futureValue);\n      that.els.node.value = futureValue;\n      that.setCursorPosition(position + offset - 1);\n      return false;\n    } if (char.match(/\\W/)) {\n      return false;\n    }\n\n    return true;\n  };\n\n  this.els.node.addEventListener('keydown', this._inputKeyDown);\n\n  this._inputBlur = function () {\n    if (!that.els.node.value.match(that.pattern)) {\n      that.els.node.value = '';\n    }\n  };\n  this.els.node.addEventListener('blur', this._inputBlur);\n};\n\nInput.prototype.getCursorPosition = function () {\n  let position = 0;\n\n  if (document.selection) {\n    this.els.node.focus();\n\n    const selectRange = document.selection.createRange();\n\n    selectRange.moveStart('character', -this.els.node.value.length);\n\n    position = selectRange.text.length;\n  } else if (this.els.node.selectionStart || this.els.node.selectionStart === '0') {\n    position = this.els.node.selectionStart;\n  }\n\n  return position;\n};\n\nInput.prototype.setCursorPosition = function (position) {\n  if (this.els.node.createTextRange) {\n    const range = this.els.node.createTextRange();\n    range.move('character', position);\n    range.select();\n  } else if (this.els.node.selectionStart) {\n    this.els.node.focus();\n    this.els.node.selectionStart = position;\n    this.els.node.selectionEnd = position;\n  } else {\n    this.els.node.focus();\n  }\n};\n\nInput.prototype.setupPattern = function () {\n  this.formatCharacters = this.els.node.getAttribute('data-format-characters') || '-()[]:.,$%@ /';\n  this.patternString = this.options.pattern;\n  this.els.node.placeholder = this.patternString;\n\n  const _initPattern = function () {\n    let formattedPatternStr = '';\n    let formattedPatternWithEmptyStr = '';\n\n    for (let i = 0; i < this.patternString.length; i += 1) {\n      const char = this.patternString[i];\n\n      if (this.formatCharacters.indexOf(char) >= 0) {\n        formattedPatternStr += char;\n        formattedPatternWithEmptyStr += char;\n      } else if (char.match(/[0-9]/)) {\n        formattedPatternStr += '[0-9]';\n        formattedPatternWithEmptyStr += '([0-9]|_)';\n      } else if (char.match(/[a-zA-Z]/)) {\n        formattedPatternStr += '[a-zA-Z]';\n        formattedPatternWithEmptyStr += '([a-zA-Z]|_)';\n      } else if (char === '*') {\n        formattedPatternStr += '[0-9a-zA-Z]';\n        formattedPatternWithEmptyStr += '([0-9a-zA-Z]|_)';\n      }\n    }\n\n    this.pattern = new RegExp(`^${formattedPatternStr}$`, 'g');\n    this.patternWithEmpty = new RegExp(`^${formattedPatternWithEmptyStr}$`, 'g');\n  }.bind(this);\n\n  _initPattern();\n};\n\n\n/**\n * Adds static events listeners.\n */\nInput.prototype.addPrefixEventListeners = function () {\n  const that = this;\n\n  this._inputKeyup = function () {\n    const oldValue = this.getAttribute('data-prefix');\n\n    if (that.els.node.value.indexOf(oldValue) !== 0) {\n      that.els.node.value = `${oldValue} `;\n    }\n  };\n\n  if (this.els.node) {\n    this.els.node.addEventListener('keyup', this._inputKeyup);\n  }\n};\n\nInput.prototype.removePatternEventListeners = function () {\n  if (this.els.node) {\n    this.els.node.addEventListener('keypress', this._inputKeyPress);\n    this.els.node.addEventListener('focus', this._inputFocus);\n    this.els.node.addEventListener('keydown', this._inputKeyDown);\n    this.els.node.addEventListener('blur', this._inputBlur);\n  }\n};\n\nInput.prototype.removePrefixEventListeners = function () {\n  if (this.els.node) {\n    this.els.node.removeEventListener('keyup', this._inputKeyup);\n  }\n};\n\nInput.prototype.die = function () {\n  if (this.options.pattern) {\n    this.removePatternEventListeners();\n  } else if (this.options.prefix) {\n    this.removePrefixEventListeners();\n  }\n  delete this;\n};\n\nInput.prototype.setPrefix = function () {\n  this.els.node.value = `${this.options.prefix} ${this.els.node.value}`;\n};\n\nexport { Input as default };\n","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@spiral-toolkit/core\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"@spiral-toolkit/datagrid\", [\"@spiral-toolkit/core\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"@spiral-toolkit/datagrid\"] = factory(require(\"@spiral-toolkit/core\"));\n\telse\n\t\troot[\"SFDataGrid\"] = factory(root[\"@spiral-toolkit/core\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","'use strict';\n\nvar objectAssign = require('object-assign');\n\n// compare and isBuffer taken from https://github.com/feross/buffer/blob/680e9e5e488f22aac27599a57dc844a6315928dd/index.js\n// original notice:\n\n/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\nfunction compare(a, b) {\n  if (a === b) {\n    return 0;\n  }\n\n  var x = a.length;\n  var y = b.length;\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i];\n      y = b[i];\n      break;\n    }\n  }\n\n  if (x < y) {\n    return -1;\n  }\n  if (y < x) {\n    return 1;\n  }\n  return 0;\n}\nfunction isBuffer(b) {\n  if (global.Buffer && typeof global.Buffer.isBuffer === 'function') {\n    return global.Buffer.isBuffer(b);\n  }\n  return !!(b != null && b._isBuffer);\n}\n\n// based on node assert, original notice:\n// NB: The URL to the CommonJS spec is kept just for tradition.\n//     node-assert has evolved a lot since then, both in API and behavior.\n\n// http://wiki.commonjs.org/wiki/Unit_Testing/1.0\n//\n// THIS IS NOT TESTED NOR LIKELY TO WORK OUTSIDE V8!\n//\n// Originally from narwhal.js (http://narwhaljs.org)\n// Copyright (c) 2009 Thomas Robinson <280north.com>\n//\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the 'Software'), to\n// deal in the Software without restriction, including without limitation the\n// rights to use, copy, modify, merge, publish, distribute, sublicense, and/or\n// sell copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n//\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN\n// ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar util = require('util/');\nvar hasOwn = Object.prototype.hasOwnProperty;\nvar pSlice = Array.prototype.slice;\nvar functionsHaveNames = (function () {\n  return function foo() {}.name === 'foo';\n}());\nfunction pToString (obj) {\n  return Object.prototype.toString.call(obj);\n}\nfunction isView(arrbuf) {\n  if (isBuffer(arrbuf)) {\n    return false;\n  }\n  if (typeof global.ArrayBuffer !== 'function') {\n    return false;\n  }\n  if (typeof ArrayBuffer.isView === 'function') {\n    return ArrayBuffer.isView(arrbuf);\n  }\n  if (!arrbuf) {\n    return false;\n  }\n  if (arrbuf instanceof DataView) {\n    return true;\n  }\n  if (arrbuf.buffer && arrbuf.buffer instanceof ArrayBuffer) {\n    return true;\n  }\n  return false;\n}\n// 1. The assert module provides functions that throw\n// AssertionError's when particular conditions are not met. The\n// assert module must conform to the following interface.\n\nvar assert = module.exports = ok;\n\n// 2. The AssertionError is defined in assert.\n// new assert.AssertionError({ message: message,\n//                             actual: actual,\n//                             expected: expected })\n\nvar regex = /\\s*function\\s+([^\\(\\s]*)\\s*/;\n// based on https://github.com/ljharb/function.prototype.name/blob/adeeeec8bfcc6068b187d7d9fb3d5bb1d3a30899/implementation.js\nfunction getName(func) {\n  if (!util.isFunction(func)) {\n    return;\n  }\n  if (functionsHaveNames) {\n    return func.name;\n  }\n  var str = func.toString();\n  var match = str.match(regex);\n  return match && match[1];\n}\nassert.AssertionError = function AssertionError(options) {\n  this.name = 'AssertionError';\n  this.actual = options.actual;\n  this.expected = options.expected;\n  this.operator = options.operator;\n  if (options.message) {\n    this.message = options.message;\n    this.generatedMessage = false;\n  } else {\n    this.message = getMessage(this);\n    this.generatedMessage = true;\n  }\n  var stackStartFunction = options.stackStartFunction || fail;\n  if (Error.captureStackTrace) {\n    Error.captureStackTrace(this, stackStartFunction);\n  } else {\n    // non v8 browsers so we can have a stacktrace\n    var err = new Error();\n    if (err.stack) {\n      var out = err.stack;\n\n      // try to strip useless frames\n      var fn_name = getName(stackStartFunction);\n      var idx = out.indexOf('\\n' + fn_name);\n      if (idx >= 0) {\n        // once we have located the function frame\n        // we need to strip out everything before it (and its line)\n        var next_line = out.indexOf('\\n', idx + 1);\n        out = out.substring(next_line + 1);\n      }\n\n      this.stack = out;\n    }\n  }\n};\n\n// assert.AssertionError instanceof Error\nutil.inherits(assert.AssertionError, Error);\n\nfunction truncate(s, n) {\n  if (typeof s === 'string') {\n    return s.length < n ? s : s.slice(0, n);\n  } else {\n    return s;\n  }\n}\nfunction inspect(something) {\n  if (functionsHaveNames || !util.isFunction(something)) {\n    return util.inspect(something);\n  }\n  var rawname = getName(something);\n  var name = rawname ? ': ' + rawname : '';\n  return '[Function' +  name + ']';\n}\nfunction getMessage(self) {\n  return truncate(inspect(self.actual), 128) + ' ' +\n         self.operator + ' ' +\n         truncate(inspect(self.expected), 128);\n}\n\n// At present only the three keys mentioned above are used and\n// understood by the spec. Implementations or sub modules can pass\n// other keys to the AssertionError's constructor - they will be\n// ignored.\n\n// 3. All of the following functions must throw an AssertionError\n// when a corresponding condition is not met, with a message that\n// may be undefined if not provided.  All assertion methods provide\n// both the actual and expected values to the assertion error for\n// display purposes.\n\nfunction fail(actual, expected, message, operator, stackStartFunction) {\n  throw new assert.AssertionError({\n    message: message,\n    actual: actual,\n    expected: expected,\n    operator: operator,\n    stackStartFunction: stackStartFunction\n  });\n}\n\n// EXTENSION! allows for well behaved errors defined elsewhere.\nassert.fail = fail;\n\n// 4. Pure assertion tests whether a value is truthy, as determined\n// by !!guard.\n// assert.ok(guard, message_opt);\n// This statement is equivalent to assert.equal(true, !!guard,\n// message_opt);. To test strictly for the value true, use\n// assert.strictEqual(true, guard, message_opt);.\n\nfunction ok(value, message) {\n  if (!value) fail(value, true, message, '==', assert.ok);\n}\nassert.ok = ok;\n\n// 5. The equality assertion tests shallow, coercive equality with\n// ==.\n// assert.equal(actual, expected, message_opt);\n\nassert.equal = function equal(actual, expected, message) {\n  if (actual != expected) fail(actual, expected, message, '==', assert.equal);\n};\n\n// 6. The non-equality assertion tests for whether two objects are not equal\n// with != assert.notEqual(actual, expected, message_opt);\n\nassert.notEqual = function notEqual(actual, expected, message) {\n  if (actual == expected) {\n    fail(actual, expected, message, '!=', assert.notEqual);\n  }\n};\n\n// 7. The equivalence assertion tests a deep equality relation.\n// assert.deepEqual(actual, expected, message_opt);\n\nassert.deepEqual = function deepEqual(actual, expected, message) {\n  if (!_deepEqual(actual, expected, false)) {\n    fail(actual, expected, message, 'deepEqual', assert.deepEqual);\n  }\n};\n\nassert.deepStrictEqual = function deepStrictEqual(actual, expected, message) {\n  if (!_deepEqual(actual, expected, true)) {\n    fail(actual, expected, message, 'deepStrictEqual', assert.deepStrictEqual);\n  }\n};\n\nfunction _deepEqual(actual, expected, strict, memos) {\n  // 7.1. All identical values are equivalent, as determined by ===.\n  if (actual === expected) {\n    return true;\n  } else if (isBuffer(actual) && isBuffer(expected)) {\n    return compare(actual, expected) === 0;\n\n  // 7.2. If the expected value is a Date object, the actual value is\n  // equivalent if it is also a Date object that refers to the same time.\n  } else if (util.isDate(actual) && util.isDate(expected)) {\n    return actual.getTime() === expected.getTime();\n\n  // 7.3 If the expected value is a RegExp object, the actual value is\n  // equivalent if it is also a RegExp object with the same source and\n  // properties (`global`, `multiline`, `lastIndex`, `ignoreCase`).\n  } else if (util.isRegExp(actual) && util.isRegExp(expected)) {\n    return actual.source === expected.source &&\n           actual.global === expected.global &&\n           actual.multiline === expected.multiline &&\n           actual.lastIndex === expected.lastIndex &&\n           actual.ignoreCase === expected.ignoreCase;\n\n  // 7.4. Other pairs that do not both pass typeof value == 'object',\n  // equivalence is determined by ==.\n  } else if ((actual === null || typeof actual !== 'object') &&\n             (expected === null || typeof expected !== 'object')) {\n    return strict ? actual === expected : actual == expected;\n\n  // If both values are instances of typed arrays, wrap their underlying\n  // ArrayBuffers in a Buffer each to increase performance\n  // This optimization requires the arrays to have the same type as checked by\n  // Object.prototype.toString (aka pToString). Never perform binary\n  // comparisons for Float*Arrays, though, since e.g. +0 === -0 but their\n  // bit patterns are not identical.\n  } else if (isView(actual) && isView(expected) &&\n             pToString(actual) === pToString(expected) &&\n             !(actual instanceof Float32Array ||\n               actual instanceof Float64Array)) {\n    return compare(new Uint8Array(actual.buffer),\n                   new Uint8Array(expected.buffer)) === 0;\n\n  // 7.5 For all other Object pairs, including Array objects, equivalence is\n  // determined by having the same number of owned properties (as verified\n  // with Object.prototype.hasOwnProperty.call), the same set of keys\n  // (although not necessarily the same order), equivalent values for every\n  // corresponding key, and an identical 'prototype' property. Note: this\n  // accounts for both named and indexed properties on Arrays.\n  } else if (isBuffer(actual) !== isBuffer(expected)) {\n    return false;\n  } else {\n    memos = memos || {actual: [], expected: []};\n\n    var actualIndex = memos.actual.indexOf(actual);\n    if (actualIndex !== -1) {\n      if (actualIndex === memos.expected.indexOf(expected)) {\n        return true;\n      }\n    }\n\n    memos.actual.push(actual);\n    memos.expected.push(expected);\n\n    return objEquiv(actual, expected, strict, memos);\n  }\n}\n\nfunction isArguments(object) {\n  return Object.prototype.toString.call(object) == '[object Arguments]';\n}\n\nfunction objEquiv(a, b, strict, actualVisitedObjects) {\n  if (a === null || a === undefined || b === null || b === undefined)\n    return false;\n  // if one is a primitive, the other must be same\n  if (util.isPrimitive(a) || util.isPrimitive(b))\n    return a === b;\n  if (strict && Object.getPrototypeOf(a) !== Object.getPrototypeOf(b))\n    return false;\n  var aIsArgs = isArguments(a);\n  var bIsArgs = isArguments(b);\n  if ((aIsArgs && !bIsArgs) || (!aIsArgs && bIsArgs))\n    return false;\n  if (aIsArgs) {\n    a = pSlice.call(a);\n    b = pSlice.call(b);\n    return _deepEqual(a, b, strict);\n  }\n  var ka = objectKeys(a);\n  var kb = objectKeys(b);\n  var key, i;\n  // having the same number of owned properties (keys incorporates\n  // hasOwnProperty)\n  if (ka.length !== kb.length)\n    return false;\n  //the same set of keys (although not necessarily the same order),\n  ka.sort();\n  kb.sort();\n  //~~~cheap key test\n  for (i = ka.length - 1; i >= 0; i--) {\n    if (ka[i] !== kb[i])\n      return false;\n  }\n  //equivalent values for every corresponding key, and\n  //~~~possibly expensive deep test\n  for (i = ka.length - 1; i >= 0; i--) {\n    key = ka[i];\n    if (!_deepEqual(a[key], b[key], strict, actualVisitedObjects))\n      return false;\n  }\n  return true;\n}\n\n// 8. The non-equivalence assertion tests for any deep inequality.\n// assert.notDeepEqual(actual, expected, message_opt);\n\nassert.notDeepEqual = function notDeepEqual(actual, expected, message) {\n  if (_deepEqual(actual, expected, false)) {\n    fail(actual, expected, message, 'notDeepEqual', assert.notDeepEqual);\n  }\n};\n\nassert.notDeepStrictEqual = notDeepStrictEqual;\nfunction notDeepStrictEqual(actual, expected, message) {\n  if (_deepEqual(actual, expected, true)) {\n    fail(actual, expected, message, 'notDeepStrictEqual', notDeepStrictEqual);\n  }\n}\n\n\n// 9. The strict equality assertion tests strict equality, as determined by ===.\n// assert.strictEqual(actual, expected, message_opt);\n\nassert.strictEqual = function strictEqual(actual, expected, message) {\n  if (actual !== expected) {\n    fail(actual, expected, message, '===', assert.strictEqual);\n  }\n};\n\n// 10. The strict non-equality assertion tests for strict inequality, as\n// determined by !==.  assert.notStrictEqual(actual, expected, message_opt);\n\nassert.notStrictEqual = function notStrictEqual(actual, expected, message) {\n  if (actual === expected) {\n    fail(actual, expected, message, '!==', assert.notStrictEqual);\n  }\n};\n\nfunction expectedException(actual, expected) {\n  if (!actual || !expected) {\n    return false;\n  }\n\n  if (Object.prototype.toString.call(expected) == '[object RegExp]') {\n    return expected.test(actual);\n  }\n\n  try {\n    if (actual instanceof expected) {\n      return true;\n    }\n  } catch (e) {\n    // Ignore.  The instanceof check doesn't work for arrow functions.\n  }\n\n  if (Error.isPrototypeOf(expected)) {\n    return false;\n  }\n\n  return expected.call({}, actual) === true;\n}\n\nfunction _tryBlock(block) {\n  var error;\n  try {\n    block();\n  } catch (e) {\n    error = e;\n  }\n  return error;\n}\n\nfunction _throws(shouldThrow, block, expected, message) {\n  var actual;\n\n  if (typeof block !== 'function') {\n    throw new TypeError('\"block\" argument must be a function');\n  }\n\n  if (typeof expected === 'string') {\n    message = expected;\n    expected = null;\n  }\n\n  actual = _tryBlock(block);\n\n  message = (expected && expected.name ? ' (' + expected.name + ').' : '.') +\n            (message ? ' ' + message : '.');\n\n  if (shouldThrow && !actual) {\n    fail(actual, expected, 'Missing expected exception' + message);\n  }\n\n  var userProvidedMessage = typeof message === 'string';\n  var isUnwantedException = !shouldThrow && util.isError(actual);\n  var isUnexpectedException = !shouldThrow && actual && !expected;\n\n  if ((isUnwantedException &&\n      userProvidedMessage &&\n      expectedException(actual, expected)) ||\n      isUnexpectedException) {\n    fail(actual, expected, 'Got unwanted exception' + message);\n  }\n\n  if ((shouldThrow && actual && expected &&\n      !expectedException(actual, expected)) || (!shouldThrow && actual)) {\n    throw actual;\n  }\n}\n\n// 11. Expected to throw an error:\n// assert.throws(block, Error_opt, message_opt);\n\nassert.throws = function(block, /*optional*/error, /*optional*/message) {\n  _throws(true, block, error, message);\n};\n\n// EXTENSION! This is annoying to write outside this module.\nassert.doesNotThrow = function(block, /*optional*/error, /*optional*/message) {\n  _throws(false, block, error, message);\n};\n\nassert.ifError = function(err) { if (err) throw err; };\n\n// Expose a strict only variant of assert\nfunction strict(value, message) {\n  if (!value) fail(value, true, message, '==', strict);\n}\nassert.strict = objectAssign(strict, assert, {\n  equal: assert.strictEqual,\n  deepEqual: assert.deepStrictEqual,\n  notEqual: assert.notStrictEqual,\n  notDeepEqual: assert.notDeepStrictEqual\n});\nassert.strict.strict = assert.strict;\n\nvar objectKeys = Object.keys || function (obj) {\n  var keys = [];\n  for (var key in obj) {\n    if (hasOwn.call(obj, key)) keys.push(key);\n  }\n  return keys;\n};\n","'use strict';\nconst strictUriEncode = require('strict-uri-encode');\nconst decodeComponent = require('decode-uri-component');\nconst splitOnFirst = require('split-on-first');\n\nconst isNullOrUndefined = value => value === null || value === undefined;\n\nfunction encoderForArrayFormat(options) {\n\tswitch (options.arrayFormat) {\n\t\tcase 'index':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tconst index = result.length;\n\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, [encode(key, options), '[', index, ']'].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [\n\t\t\t\t\t...result,\n\t\t\t\t\t[encode(key, options), '[', encode(index, options), ']=', encode(value, options)].join('')\n\t\t\t\t];\n\t\t\t};\n\n\t\tcase 'bracket':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, [encode(key, options), '[]'].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [...result, [encode(key, options), '[]=', encode(value, options)].join('')];\n\t\t\t};\n\n\t\tcase 'comma':\n\t\tcase 'separator':\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (value === null || value === undefined || value.length === 0) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (result.length === 0) {\n\t\t\t\t\treturn [[encode(key, options), '=', encode(value, options)].join('')];\n\t\t\t\t}\n\n\t\t\t\treturn [[result, encode(value, options)].join(options.arrayFormatSeparator)];\n\t\t\t};\n\n\t\tdefault:\n\t\t\treturn key => (result, value) => {\n\t\t\t\tif (\n\t\t\t\t\tvalue === undefined ||\n\t\t\t\t\t(options.skipNull && value === null) ||\n\t\t\t\t\t(options.skipEmptyString && value === '')\n\t\t\t\t) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (value === null) {\n\t\t\t\t\treturn [...result, encode(key, options)];\n\t\t\t\t}\n\n\t\t\t\treturn [...result, [encode(key, options), '=', encode(value, options)].join('')];\n\t\t\t};\n\t}\n}\n\nfunction parserForArrayFormat(options) {\n\tlet result;\n\n\tswitch (options.arrayFormat) {\n\t\tcase 'index':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /\\[(\\d*)\\]$/.exec(key);\n\n\t\t\t\tkey = key.replace(/\\[\\d*\\]$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = {};\n\t\t\t\t}\n\n\t\t\t\taccumulator[key][result[1]] = value;\n\t\t\t};\n\n\t\tcase 'bracket':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tresult = /(\\[\\])$/.exec(key);\n\t\t\t\tkey = key.replace(/\\[\\]$/, '');\n\n\t\t\t\tif (!result) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = [value];\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\n\t\tcase 'comma':\n\t\tcase 'separator':\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tconst isArray = typeof value === 'string' && value.split('').indexOf(options.arrayFormatSeparator) > -1;\n\t\t\t\tconst newValue = isArray ? value.split(options.arrayFormatSeparator).map(item => decode(item, options)) : value === null ? value : decode(value, options);\n\t\t\t\taccumulator[key] = newValue;\n\t\t\t};\n\n\t\tdefault:\n\t\t\treturn (key, value, accumulator) => {\n\t\t\t\tif (accumulator[key] === undefined) {\n\t\t\t\t\taccumulator[key] = value;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\taccumulator[key] = [].concat(accumulator[key], value);\n\t\t\t};\n\t}\n}\n\nfunction validateArrayFormatSeparator(value) {\n\tif (typeof value !== 'string' || value.length !== 1) {\n\t\tthrow new TypeError('arrayFormatSeparator must be single character string');\n\t}\n}\n\nfunction encode(value, options) {\n\tif (options.encode) {\n\t\treturn options.strict ? strictUriEncode(value) : encodeURIComponent(value);\n\t}\n\n\treturn value;\n}\n\nfunction decode(value, options) {\n\tif (options.decode) {\n\t\treturn decodeComponent(value);\n\t}\n\n\treturn value;\n}\n\nfunction keysSorter(input) {\n\tif (Array.isArray(input)) {\n\t\treturn input.sort();\n\t}\n\n\tif (typeof input === 'object') {\n\t\treturn keysSorter(Object.keys(input))\n\t\t\t.sort((a, b) => Number(a) - Number(b))\n\t\t\t.map(key => input[key]);\n\t}\n\n\treturn input;\n}\n\nfunction removeHash(input) {\n\tconst hashStart = input.indexOf('#');\n\tif (hashStart !== -1) {\n\t\tinput = input.slice(0, hashStart);\n\t}\n\n\treturn input;\n}\n\nfunction getHash(url) {\n\tlet hash = '';\n\tconst hashStart = url.indexOf('#');\n\tif (hashStart !== -1) {\n\t\thash = url.slice(hashStart);\n\t}\n\n\treturn hash;\n}\n\nfunction extract(input) {\n\tinput = removeHash(input);\n\tconst queryStart = input.indexOf('?');\n\tif (queryStart === -1) {\n\t\treturn '';\n\t}\n\n\treturn input.slice(queryStart + 1);\n}\n\nfunction parseValue(value, options) {\n\tif (options.parseNumbers && !Number.isNaN(Number(value)) && (typeof value === 'string' && value.trim() !== '')) {\n\t\tvalue = Number(value);\n\t} else if (options.parseBooleans && value !== null && (value.toLowerCase() === 'true' || value.toLowerCase() === 'false')) {\n\t\tvalue = value.toLowerCase() === 'true';\n\t}\n\n\treturn value;\n}\n\nfunction parse(input, options) {\n\toptions = Object.assign({\n\t\tdecode: true,\n\t\tsort: true,\n\t\tarrayFormat: 'none',\n\t\tarrayFormatSeparator: ',',\n\t\tparseNumbers: false,\n\t\tparseBooleans: false\n\t}, options);\n\n\tvalidateArrayFormatSeparator(options.arrayFormatSeparator);\n\n\tconst formatter = parserForArrayFormat(options);\n\n\t// Create an object with no prototype\n\tconst ret = Object.create(null);\n\n\tif (typeof input !== 'string') {\n\t\treturn ret;\n\t}\n\n\tinput = input.trim().replace(/^[?#&]/, '');\n\n\tif (!input) {\n\t\treturn ret;\n\t}\n\n\tfor (const param of input.split('&')) {\n\t\tlet [key, value] = splitOnFirst(options.decode ? param.replace(/\\+/g, ' ') : param, '=');\n\n\t\t// Missing `=` should be `null`:\n\t\t// http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n\t\tvalue = value === undefined ? null : options.arrayFormat === 'comma' ? value : decode(value, options);\n\t\tformatter(decode(key, options), value, ret);\n\t}\n\n\tfor (const key of Object.keys(ret)) {\n\t\tconst value = ret[key];\n\t\tif (typeof value === 'object' && value !== null) {\n\t\t\tfor (const k of Object.keys(value)) {\n\t\t\t\tvalue[k] = parseValue(value[k], options);\n\t\t\t}\n\t\t} else {\n\t\t\tret[key] = parseValue(value, options);\n\t\t}\n\t}\n\n\tif (options.sort === false) {\n\t\treturn ret;\n\t}\n\n\treturn (options.sort === true ? Object.keys(ret).sort() : Object.keys(ret).sort(options.sort)).reduce((result, key) => {\n\t\tconst value = ret[key];\n\t\tif (Boolean(value) && typeof value === 'object' && !Array.isArray(value)) {\n\t\t\t// Sort object keys, not values\n\t\t\tresult[key] = keysSorter(value);\n\t\t} else {\n\t\t\tresult[key] = value;\n\t\t}\n\n\t\treturn result;\n\t}, Object.create(null));\n}\n\nexports.extract = extract;\nexports.parse = parse;\n\nexports.stringify = (object, options) => {\n\tif (!object) {\n\t\treturn '';\n\t}\n\n\toptions = Object.assign({\n\t\tencode: true,\n\t\tstrict: true,\n\t\tarrayFormat: 'none',\n\t\tarrayFormatSeparator: ','\n\t}, options);\n\n\tvalidateArrayFormatSeparator(options.arrayFormatSeparator);\n\n\tconst shouldFilter = key => (\n\t\t(options.skipNull && isNullOrUndefined(object[key])) ||\n\t\t(options.skipEmptyString && object[key] === '')\n\t);\n\n\tconst formatter = encoderForArrayFormat(options);\n\n\tconst objectCopy = {};\n\n\tfor (const key of Object.keys(object)) {\n\t\tif (!shouldFilter(key)) {\n\t\t\tobjectCopy[key] = object[key];\n\t\t}\n\t}\n\n\tconst keys = Object.keys(objectCopy);\n\n\tif (options.sort !== false) {\n\t\tkeys.sort(options.sort);\n\t}\n\n\treturn keys.map(key => {\n\t\tconst value = object[key];\n\n\t\tif (value === undefined) {\n\t\t\treturn '';\n\t\t}\n\n\t\tif (value === null) {\n\t\t\treturn encode(key, options);\n\t\t}\n\n\t\tif (Array.isArray(value)) {\n\t\t\treturn value\n\t\t\t\t.reduce(formatter(key), [])\n\t\t\t\t.join('&');\n\t\t}\n\n\t\treturn encode(key, options) + '=' + encode(value, options);\n\t}).filter(x => x.length > 0).join('&');\n};\n\nexports.parseUrl = (input, options) => {\n\treturn {\n\t\turl: removeHash(input).split('?')[0] || '',\n\t\tquery: parse(extract(input), options)\n\t};\n};\n\nexports.stringifyUrl = (input, options) => {\n\tconst url = removeHash(input.url).split('?')[0] || '';\n\tconst queryFromUrl = exports.extract(input.url);\n\tconst parsedQueryFromUrl = exports.parse(queryFromUrl);\n\tconst hash = getHash(input.url);\n\tconst query = Object.assign(parsedQueryFromUrl, input.query);\n\tlet queryString = exports.stringify(query, options);\n\tif (queryString) {\n\t\tqueryString = `?${queryString}`;\n\t}\n\n\treturn `${url}${queryString}${hash}`;\n};\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n'use strict';\n/* eslint-disable no-unused-vars */\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n\tif (val === null || val === undefined) {\n\t\tthrow new TypeError('Object.assign cannot be called with null or undefined');\n\t}\n\n\treturn Object(val);\n}\n\nfunction shouldUseNative() {\n\ttry {\n\t\tif (!Object.assign) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Detect buggy property enumeration order in older V8 versions.\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\t\tvar test1 = new String('abc');  // eslint-disable-line no-new-wrappers\n\t\ttest1[5] = 'de';\n\t\tif (Object.getOwnPropertyNames(test1)[0] === '5') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test2 = {};\n\t\tfor (var i = 0; i < 10; i++) {\n\t\t\ttest2['_' + String.fromCharCode(i)] = i;\n\t\t}\n\t\tvar order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n\t\t\treturn test2[n];\n\t\t});\n\t\tif (order2.join('') !== '0123456789') {\n\t\t\treturn false;\n\t\t}\n\n\t\t// https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\t\tvar test3 = {};\n\t\t'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n\t\t\ttest3[letter] = letter;\n\t\t});\n\t\tif (Object.keys(Object.assign({}, test3)).join('') !==\n\t\t\t\t'abcdefghijklmnopqrst') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t} catch (err) {\n\t\t// We don't expect any of the above to throw, but better to be safe.\n\t\treturn false;\n\t}\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n\tvar from;\n\tvar to = toObject(target);\n\tvar symbols;\n\n\tfor (var s = 1; s < arguments.length; s++) {\n\t\tfrom = Object(arguments[s]);\n\n\t\tfor (var key in from) {\n\t\t\tif (hasOwnProperty.call(from, key)) {\n\t\t\t\tto[key] = from[key];\n\t\t\t}\n\t\t}\n\n\t\tif (getOwnPropertySymbols) {\n\t\t\tsymbols = getOwnPropertySymbols(from);\n\t\t\tfor (var i = 0; i < symbols.length; i++) {\n\t\t\t\tif (propIsEnumerable.call(from, symbols[i])) {\n\t\t\t\t\tto[symbols[i]] = from[symbols[i]];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn to;\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar getOwnPropertyDescriptors = Object.getOwnPropertyDescriptors ||\n  function getOwnPropertyDescriptors(obj) {\n    var keys = Object.keys(obj);\n    var descriptors = {};\n    for (var i = 0; i < keys.length; i++) {\n      descriptors[keys[i]] = Object.getOwnPropertyDescriptor(obj, keys[i]);\n    }\n    return descriptors;\n  };\n\nvar formatRegExp = /%[sdj%]/g;\nexports.format = function(f) {\n  if (!isString(f)) {\n    var objects = [];\n    for (var i = 0; i < arguments.length; i++) {\n      objects.push(inspect(arguments[i]));\n    }\n    return objects.join(' ');\n  }\n\n  var i = 1;\n  var args = arguments;\n  var len = args.length;\n  var str = String(f).replace(formatRegExp, function(x) {\n    if (x === '%%') return '%';\n    if (i >= len) return x;\n    switch (x) {\n      case '%s': return String(args[i++]);\n      case '%d': return Number(args[i++]);\n      case '%j':\n        try {\n          return JSON.stringify(args[i++]);\n        } catch (_) {\n          return '[Circular]';\n        }\n      default:\n        return x;\n    }\n  });\n  for (var x = args[i]; i < len; x = args[++i]) {\n    if (isNull(x) || !isObject(x)) {\n      str += ' ' + x;\n    } else {\n      str += ' ' + inspect(x);\n    }\n  }\n  return str;\n};\n\n\n// Mark that a method should not be used.\n// Returns a modified function which warns once by default.\n// If --no-deprecation is set, then it is a no-op.\nexports.deprecate = function(fn, msg) {\n  if (typeof process !== 'undefined' && process.noDeprecation === true) {\n    return fn;\n  }\n\n  // Allow for deprecating things in the process of starting up.\n  if (typeof process === 'undefined') {\n    return function() {\n      return exports.deprecate(fn, msg).apply(this, arguments);\n    };\n  }\n\n  var warned = false;\n  function deprecated() {\n    if (!warned) {\n      if (process.throwDeprecation) {\n        throw new Error(msg);\n      } else if (process.traceDeprecation) {\n        console.trace(msg);\n      } else {\n        console.error(msg);\n      }\n      warned = true;\n    }\n    return fn.apply(this, arguments);\n  }\n\n  return deprecated;\n};\n\n\nvar debugs = {};\nvar debugEnviron;\nexports.debuglog = function(set) {\n  if (isUndefined(debugEnviron))\n    debugEnviron = process.env.NODE_DEBUG || '';\n  set = set.toUpperCase();\n  if (!debugs[set]) {\n    if (new RegExp('\\\\b' + set + '\\\\b', 'i').test(debugEnviron)) {\n      var pid = process.pid;\n      debugs[set] = function() {\n        var msg = exports.format.apply(exports, arguments);\n        console.error('%s %d: %s', set, pid, msg);\n      };\n    } else {\n      debugs[set] = function() {};\n    }\n  }\n  return debugs[set];\n};\n\n\n/**\n * Echos the value of a value. Trys to print the value out\n * in the best way possible given the different types.\n *\n * @param {Object} obj The object to print out.\n * @param {Object} opts Optional options object that alters the output.\n */\n/* legacy: obj, showHidden, depth, colors*/\nfunction inspect(obj, opts) {\n  // default options\n  var ctx = {\n    seen: [],\n    stylize: stylizeNoColor\n  };\n  // legacy...\n  if (arguments.length >= 3) ctx.depth = arguments[2];\n  if (arguments.length >= 4) ctx.colors = arguments[3];\n  if (isBoolean(opts)) {\n    // legacy...\n    ctx.showHidden = opts;\n  } else if (opts) {\n    // got an \"options\" object\n    exports._extend(ctx, opts);\n  }\n  // set default options\n  if (isUndefined(ctx.showHidden)) ctx.showHidden = false;\n  if (isUndefined(ctx.depth)) ctx.depth = 2;\n  if (isUndefined(ctx.colors)) ctx.colors = false;\n  if (isUndefined(ctx.customInspect)) ctx.customInspect = true;\n  if (ctx.colors) ctx.stylize = stylizeWithColor;\n  return formatValue(ctx, obj, ctx.depth);\n}\nexports.inspect = inspect;\n\n\n// http://en.wikipedia.org/wiki/ANSI_escape_code#graphics\ninspect.colors = {\n  'bold' : [1, 22],\n  'italic' : [3, 23],\n  'underline' : [4, 24],\n  'inverse' : [7, 27],\n  'white' : [37, 39],\n  'grey' : [90, 39],\n  'black' : [30, 39],\n  'blue' : [34, 39],\n  'cyan' : [36, 39],\n  'green' : [32, 39],\n  'magenta' : [35, 39],\n  'red' : [31, 39],\n  'yellow' : [33, 39]\n};\n\n// Don't use 'blue' not visible on cmd.exe\ninspect.styles = {\n  'special': 'cyan',\n  'number': 'yellow',\n  'boolean': 'yellow',\n  'undefined': 'grey',\n  'null': 'bold',\n  'string': 'green',\n  'date': 'magenta',\n  // \"name\": intentionally not styling\n  'regexp': 'red'\n};\n\n\nfunction stylizeWithColor(str, styleType) {\n  var style = inspect.styles[styleType];\n\n  if (style) {\n    return '\\u001b[' + inspect.colors[style][0] + 'm' + str +\n           '\\u001b[' + inspect.colors[style][1] + 'm';\n  } else {\n    return str;\n  }\n}\n\n\nfunction stylizeNoColor(str, styleType) {\n  return str;\n}\n\n\nfunction arrayToHash(array) {\n  var hash = {};\n\n  array.forEach(function(val, idx) {\n    hash[val] = true;\n  });\n\n  return hash;\n}\n\n\nfunction formatValue(ctx, value, recurseTimes) {\n  // Provide a hook for user-specified inspect functions.\n  // Check that value is an object with an inspect function on it\n  if (ctx.customInspect &&\n      value &&\n      isFunction(value.inspect) &&\n      // Filter out the util module, it's inspect function is special\n      value.inspect !== exports.inspect &&\n      // Also filter out any prototype objects using the circular check.\n      !(value.constructor && value.constructor.prototype === value)) {\n    var ret = value.inspect(recurseTimes, ctx);\n    if (!isString(ret)) {\n      ret = formatValue(ctx, ret, recurseTimes);\n    }\n    return ret;\n  }\n\n  // Primitive types cannot have properties\n  var primitive = formatPrimitive(ctx, value);\n  if (primitive) {\n    return primitive;\n  }\n\n  // Look up the keys of the object.\n  var keys = Object.keys(value);\n  var visibleKeys = arrayToHash(keys);\n\n  if (ctx.showHidden) {\n    keys = Object.getOwnPropertyNames(value);\n  }\n\n  // IE doesn't make error fields non-enumerable\n  // http://msdn.microsoft.com/en-us/library/ie/dww52sbt(v=vs.94).aspx\n  if (isError(value)\n      && (keys.indexOf('message') >= 0 || keys.indexOf('description') >= 0)) {\n    return formatError(value);\n  }\n\n  // Some type of object without properties can be shortcutted.\n  if (keys.length === 0) {\n    if (isFunction(value)) {\n      var name = value.name ? ': ' + value.name : '';\n      return ctx.stylize('[Function' + name + ']', 'special');\n    }\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    }\n    if (isDate(value)) {\n      return ctx.stylize(Date.prototype.toString.call(value), 'date');\n    }\n    if (isError(value)) {\n      return formatError(value);\n    }\n  }\n\n  var base = '', array = false, braces = ['{', '}'];\n\n  // Make Array say that they are Array\n  if (isArray(value)) {\n    array = true;\n    braces = ['[', ']'];\n  }\n\n  // Make functions say that they are functions\n  if (isFunction(value)) {\n    var n = value.name ? ': ' + value.name : '';\n    base = ' [Function' + n + ']';\n  }\n\n  // Make RegExps say that they are RegExps\n  if (isRegExp(value)) {\n    base = ' ' + RegExp.prototype.toString.call(value);\n  }\n\n  // Make dates with properties first say the date\n  if (isDate(value)) {\n    base = ' ' + Date.prototype.toUTCString.call(value);\n  }\n\n  // Make error with message first say the error\n  if (isError(value)) {\n    base = ' ' + formatError(value);\n  }\n\n  if (keys.length === 0 && (!array || value.length == 0)) {\n    return braces[0] + base + braces[1];\n  }\n\n  if (recurseTimes < 0) {\n    if (isRegExp(value)) {\n      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');\n    } else {\n      return ctx.stylize('[Object]', 'special');\n    }\n  }\n\n  ctx.seen.push(value);\n\n  var output;\n  if (array) {\n    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n  } else {\n    output = keys.map(function(key) {\n      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n    });\n  }\n\n  ctx.seen.pop();\n\n  return reduceToSingleString(output, base, braces);\n}\n\n\nfunction formatPrimitive(ctx, value) {\n  if (isUndefined(value))\n    return ctx.stylize('undefined', 'undefined');\n  if (isString(value)) {\n    var simple = '\\'' + JSON.stringify(value).replace(/^\"|\"$/g, '')\n                                             .replace(/'/g, \"\\\\'\")\n                                             .replace(/\\\\\"/g, '\"') + '\\'';\n    return ctx.stylize(simple, 'string');\n  }\n  if (isNumber(value))\n    return ctx.stylize('' + value, 'number');\n  if (isBoolean(value))\n    return ctx.stylize('' + value, 'boolean');\n  // For some reason typeof null is \"object\", so special case here.\n  if (isNull(value))\n    return ctx.stylize('null', 'null');\n}\n\n\nfunction formatError(value) {\n  return '[' + Error.prototype.toString.call(value) + ']';\n}\n\n\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n  var output = [];\n  for (var i = 0, l = value.length; i < l; ++i) {\n    if (hasOwnProperty(value, String(i))) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          String(i), true));\n    } else {\n      output.push('');\n    }\n  }\n  keys.forEach(function(key) {\n    if (!key.match(/^\\d+$/)) {\n      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,\n          key, true));\n    }\n  });\n  return output;\n}\n\n\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n  var name, str, desc;\n  desc = Object.getOwnPropertyDescriptor(value, key) || { value: value[key] };\n  if (desc.get) {\n    if (desc.set) {\n      str = ctx.stylize('[Getter/Setter]', 'special');\n    } else {\n      str = ctx.stylize('[Getter]', 'special');\n    }\n  } else {\n    if (desc.set) {\n      str = ctx.stylize('[Setter]', 'special');\n    }\n  }\n  if (!hasOwnProperty(visibleKeys, key)) {\n    name = '[' + key + ']';\n  }\n  if (!str) {\n    if (ctx.seen.indexOf(desc.value) < 0) {\n      if (isNull(recurseTimes)) {\n        str = formatValue(ctx, desc.value, null);\n      } else {\n        str = formatValue(ctx, desc.value, recurseTimes - 1);\n      }\n      if (str.indexOf('\\n') > -1) {\n        if (array) {\n          str = str.split('\\n').map(function(line) {\n            return '  ' + line;\n          }).join('\\n').substr(2);\n        } else {\n          str = '\\n' + str.split('\\n').map(function(line) {\n            return '   ' + line;\n          }).join('\\n');\n        }\n      }\n    } else {\n      str = ctx.stylize('[Circular]', 'special');\n    }\n  }\n  if (isUndefined(name)) {\n    if (array && key.match(/^\\d+$/)) {\n      return str;\n    }\n    name = JSON.stringify('' + key);\n    if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n      name = name.substr(1, name.length - 2);\n      name = ctx.stylize(name, 'name');\n    } else {\n      name = name.replace(/'/g, \"\\\\'\")\n                 .replace(/\\\\\"/g, '\"')\n                 .replace(/(^\"|\"$)/g, \"'\");\n      name = ctx.stylize(name, 'string');\n    }\n  }\n\n  return name + ': ' + str;\n}\n\n\nfunction reduceToSingleString(output, base, braces) {\n  var numLinesEst = 0;\n  var length = output.reduce(function(prev, cur) {\n    numLinesEst++;\n    if (cur.indexOf('\\n') >= 0) numLinesEst++;\n    return prev + cur.replace(/\\u001b\\[\\d\\d?m/g, '').length + 1;\n  }, 0);\n\n  if (length > 60) {\n    return braces[0] +\n           (base === '' ? '' : base + '\\n ') +\n           ' ' +\n           output.join(',\\n  ') +\n           ' ' +\n           braces[1];\n  }\n\n  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];\n}\n\n\n// NOTE: These type checking functions intentionally don't use `instanceof`\n// because it is fragile and can be easily faked with `Object.create()`.\nfunction isArray(ar) {\n  return Array.isArray(ar);\n}\nexports.isArray = isArray;\n\nfunction isBoolean(arg) {\n  return typeof arg === 'boolean';\n}\nexports.isBoolean = isBoolean;\n\nfunction isNull(arg) {\n  return arg === null;\n}\nexports.isNull = isNull;\n\nfunction isNullOrUndefined(arg) {\n  return arg == null;\n}\nexports.isNullOrUndefined = isNullOrUndefined;\n\nfunction isNumber(arg) {\n  return typeof arg === 'number';\n}\nexports.isNumber = isNumber;\n\nfunction isString(arg) {\n  return typeof arg === 'string';\n}\nexports.isString = isString;\n\nfunction isSymbol(arg) {\n  return typeof arg === 'symbol';\n}\nexports.isSymbol = isSymbol;\n\nfunction isUndefined(arg) {\n  return arg === void 0;\n}\nexports.isUndefined = isUndefined;\n\nfunction isRegExp(re) {\n  return isObject(re) && objectToString(re) === '[object RegExp]';\n}\nexports.isRegExp = isRegExp;\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\nexports.isObject = isObject;\n\nfunction isDate(d) {\n  return isObject(d) && objectToString(d) === '[object Date]';\n}\nexports.isDate = isDate;\n\nfunction isError(e) {\n  return isObject(e) &&\n      (objectToString(e) === '[object Error]' || e instanceof Error);\n}\nexports.isError = isError;\n\nfunction isFunction(arg) {\n  return typeof arg === 'function';\n}\nexports.isFunction = isFunction;\n\nfunction isPrimitive(arg) {\n  return arg === null ||\n         typeof arg === 'boolean' ||\n         typeof arg === 'number' ||\n         typeof arg === 'string' ||\n         typeof arg === 'symbol' ||  // ES6 symbol\n         typeof arg === 'undefined';\n}\nexports.isPrimitive = isPrimitive;\n\nexports.isBuffer = require('./support/isBuffer');\n\nfunction objectToString(o) {\n  return Object.prototype.toString.call(o);\n}\n\n\nfunction pad(n) {\n  return n < 10 ? '0' + n.toString(10) : n.toString(10);\n}\n\n\nvar months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep',\n              'Oct', 'Nov', 'Dec'];\n\n// 26 Feb 16:19:34\nfunction timestamp() {\n  var d = new Date();\n  var time = [pad(d.getHours()),\n              pad(d.getMinutes()),\n              pad(d.getSeconds())].join(':');\n  return [d.getDate(), months[d.getMonth()], time].join(' ');\n}\n\n\n// log is just a thin wrapper to console.log that prepends a timestamp\nexports.log = function() {\n  console.log('%s - %s', timestamp(), exports.format.apply(exports, arguments));\n};\n\n\n/**\n * Inherit the prototype methods from one constructor into another.\n *\n * The Function.prototype.inherits from lang.js rewritten as a standalone\n * function (not on Function.prototype). NOTE: If this file is to be loaded\n * during bootstrapping this function needs to be rewritten using some native\n * functions as prototype setup using normal JavaScript does not work as\n * expected during bootstrapping (see mirror.js in r114903).\n *\n * @param {function} ctor Constructor function which needs to inherit the\n *     prototype.\n * @param {function} superCtor Constructor function to inherit prototype from.\n */\nexports.inherits = require('inherits');\n\nexports._extend = function(origin, add) {\n  // Don't do anything if add isn't an object\n  if (!add || !isObject(add)) return origin;\n\n  var keys = Object.keys(add);\n  var i = keys.length;\n  while (i--) {\n    origin[keys[i]] = add[keys[i]];\n  }\n  return origin;\n};\n\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nvar kCustomPromisifiedSymbol = typeof Symbol !== 'undefined' ? Symbol('util.promisify.custom') : undefined;\n\nexports.promisify = function promisify(original) {\n  if (typeof original !== 'function')\n    throw new TypeError('The \"original\" argument must be of type Function');\n\n  if (kCustomPromisifiedSymbol && original[kCustomPromisifiedSymbol]) {\n    var fn = original[kCustomPromisifiedSymbol];\n    if (typeof fn !== 'function') {\n      throw new TypeError('The \"util.promisify.custom\" argument must be of type Function');\n    }\n    Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n      value: fn, enumerable: false, writable: false, configurable: true\n    });\n    return fn;\n  }\n\n  function fn() {\n    var promiseResolve, promiseReject;\n    var promise = new Promise(function (resolve, reject) {\n      promiseResolve = resolve;\n      promiseReject = reject;\n    });\n\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n    args.push(function (err, value) {\n      if (err) {\n        promiseReject(err);\n      } else {\n        promiseResolve(value);\n      }\n    });\n\n    try {\n      original.apply(this, args);\n    } catch (err) {\n      promiseReject(err);\n    }\n\n    return promise;\n  }\n\n  Object.setPrototypeOf(fn, Object.getPrototypeOf(original));\n\n  if (kCustomPromisifiedSymbol) Object.defineProperty(fn, kCustomPromisifiedSymbol, {\n    value: fn, enumerable: false, writable: false, configurable: true\n  });\n  return Object.defineProperties(\n    fn,\n    getOwnPropertyDescriptors(original)\n  );\n}\n\nexports.promisify.custom = kCustomPromisifiedSymbol\n\nfunction callbackifyOnRejected(reason, cb) {\n  // `!reason` guard inspired by bluebird (Ref: https://goo.gl/t5IS6M).\n  // Because `null` is a special error value in callbacks which means \"no error\n  // occurred\", we error-wrap so the callback consumer can distinguish between\n  // \"the promise rejected with null\" or \"the promise fulfilled with undefined\".\n  if (!reason) {\n    var newReason = new Error('Promise was rejected with a falsy value');\n    newReason.reason = reason;\n    reason = newReason;\n  }\n  return cb(reason);\n}\n\nfunction callbackify(original) {\n  if (typeof original !== 'function') {\n    throw new TypeError('The \"original\" argument must be of type Function');\n  }\n\n  // We DO NOT return the promise as it gives the user a false sense that\n  // the promise is actually somehow related to the callback's execution\n  // and that the callback throwing will reject the promise.\n  function callbackified() {\n    var args = [];\n    for (var i = 0; i < arguments.length; i++) {\n      args.push(arguments[i]);\n    }\n\n    var maybeCb = args.pop();\n    if (typeof maybeCb !== 'function') {\n      throw new TypeError('The last argument must be of type Function');\n    }\n    var self = this;\n    var cb = function() {\n      return maybeCb.apply(self, arguments);\n    };\n    // In true node style we process the callback on `nextTick` with all the\n    // implications (stack, `uncaughtException`, `async_hooks`)\n    original.apply(this, args)\n      .then(function(ret) { process.nextTick(cb, null, ret) },\n            function(rej) { process.nextTick(callbackifyOnRejected, rej, cb) });\n  }\n\n  Object.setPrototypeOf(callbackified, Object.getPrototypeOf(original));\n  Object.defineProperties(callbackified,\n                          getOwnPropertyDescriptors(original));\n  return callbackified;\n}\nexports.callbackify = callbackify;\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","module.exports = function isBuffer(arg) {\n  return arg && typeof arg === 'object'\n    && typeof arg.copy === 'function'\n    && typeof arg.fill === 'function'\n    && typeof arg.readUInt8 === 'function';\n}","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    ctor.super_ = superCtor\n    var TempCtor = function () {}\n    TempCtor.prototype = superCtor.prototype\n    ctor.prototype = new TempCtor()\n    ctor.prototype.constructor = ctor\n  }\n}\n","'use strict';\nmodule.exports = str => encodeURIComponent(str).replace(/[!'()*]/g, x => `%${x.charCodeAt(0).toString(16).toUpperCase()}`);\n","'use strict';\nvar token = '%[a-f0-9]{2}';\nvar singleMatcher = new RegExp(token, 'gi');\nvar multiMatcher = new RegExp('(' + token + ')+', 'gi');\n\nfunction decodeComponents(components, split) {\n\ttry {\n\t\t// Try to decode the entire string first\n\t\treturn decodeURIComponent(components.join(''));\n\t} catch (err) {\n\t\t// Do nothing\n\t}\n\n\tif (components.length === 1) {\n\t\treturn components;\n\t}\n\n\tsplit = split || 1;\n\n\t// Split the array in 2 parts\n\tvar left = components.slice(0, split);\n\tvar right = components.slice(split);\n\n\treturn Array.prototype.concat.call([], decodeComponents(left), decodeComponents(right));\n}\n\nfunction decode(input) {\n\ttry {\n\t\treturn decodeURIComponent(input);\n\t} catch (err) {\n\t\tvar tokens = input.match(singleMatcher);\n\n\t\tfor (var i = 1; i < tokens.length; i++) {\n\t\t\tinput = decodeComponents(tokens, i).join('');\n\n\t\t\ttokens = input.match(singleMatcher);\n\t\t}\n\n\t\treturn input;\n\t}\n}\n\nfunction customDecodeURIComponent(input) {\n\t// Keep track of all the replacements and prefill the map with the `BOM`\n\tvar replaceMap = {\n\t\t'%FE%FF': '\\uFFFD\\uFFFD',\n\t\t'%FF%FE': '\\uFFFD\\uFFFD'\n\t};\n\n\tvar match = multiMatcher.exec(input);\n\twhile (match) {\n\t\ttry {\n\t\t\t// Decode as big chunks as possible\n\t\t\treplaceMap[match[0]] = decodeURIComponent(match[0]);\n\t\t} catch (err) {\n\t\t\tvar result = decode(match[0]);\n\n\t\t\tif (result !== match[0]) {\n\t\t\t\treplaceMap[match[0]] = result;\n\t\t\t}\n\t\t}\n\n\t\tmatch = multiMatcher.exec(input);\n\t}\n\n\t// Add `%C2` at the end of the map to make sure it does not replace the combinator before everything else\n\treplaceMap['%C2'] = '\\uFFFD';\n\n\tvar entries = Object.keys(replaceMap);\n\n\tfor (var i = 0; i < entries.length; i++) {\n\t\t// Replace all decoded components\n\t\tvar key = entries[i];\n\t\tinput = input.replace(new RegExp(key, 'g'), replaceMap[key]);\n\t}\n\n\treturn input;\n}\n\nmodule.exports = function (encodedURI) {\n\tif (typeof encodedURI !== 'string') {\n\t\tthrow new TypeError('Expected `encodedURI` to be of type `string`, got `' + typeof encodedURI + '`');\n\t}\n\n\ttry {\n\t\tencodedURI = encodedURI.replace(/\\+/g, ' ');\n\n\t\t// Try the built in decoder first\n\t\treturn decodeURIComponent(encodedURI);\n\t} catch (err) {\n\t\t// Fallback to a more advanced decoder\n\t\treturn customDecodeURIComponent(encodedURI);\n\t}\n};\n","'use strict';\n\nmodule.exports = (string, separator) => {\n\tif (!(typeof string === 'string' && typeof separator === 'string')) {\n\t\tthrow new TypeError('Expected the arguments to be of type `string`');\n\t}\n\n\tif (separator === '') {\n\t\treturn [string];\n\t}\n\n\tconst separatorIndex = string.indexOf(separator);\n\n\tif (separatorIndex === -1) {\n\t\treturn [string];\n\t}\n\n\treturn [\n\t\tstring.slice(0, separatorIndex),\n\t\tstring.slice(separatorIndex + separator.length)\n\t];\n};\n","export var SortDirection;\r\n(function (SortDirection) {\r\n    SortDirection[\"ASC\"] = \"asc\";\r\n    SortDirection[\"DESC\"] = \"desc\";\r\n})(SortDirection || (SortDirection = {}));\r\nexport var RequestMethod;\r\n(function (RequestMethod) {\r\n    RequestMethod[\"GET\"] = \"GET\";\r\n    RequestMethod[\"POST\"] = \"POST\";\r\n    RequestMethod[\"DELETE\"] = \"DELETE\";\r\n    RequestMethod[\"PUT\"] = \"PUT\";\r\n    RequestMethod[\"PATCH\"] = \"PATCH\";\r\n})(RequestMethod || (RequestMethod = {}));\r\nexport const CURSOR_ID_FIELD = 'cid';\r\nexport const LAST_ID_FIELD = 'lid';\r\nexport const pageParams = ['page', 'limit', CURSOR_ID_FIELD, LAST_ID_FIELD];\r\nexport const sortParams = ['sortBy', 'sortDir'];\r\n","import { SortDirection } from './constants';\r\nexport const DEFAULT_LIMIT = 25;\r\nexport class DatagridState {\r\n    constructor(parent) {\r\n        this.parent = parent;\r\n        this.state = {\r\n            loading: false,\r\n            paginator: {\r\n                page: 1,\r\n                limit: DEFAULT_LIMIT,\r\n            },\r\n            sortDir: SortDirection.ASC,\r\n            data: [],\r\n            formData: {},\r\n        };\r\n    }\r\n    get isLoading() {\r\n        return this.state.loading;\r\n    }\r\n    startLoading() {\r\n        this.state.loading = true;\r\n    }\r\n    stopLoading() {\r\n        this.state.loading = false;\r\n    }\r\n    get data() {\r\n        return this.state.data;\r\n    }\r\n    get paginate() {\r\n        return this.state.paginator;\r\n    }\r\n    get urlData() {\r\n        return this.state.urlData;\r\n    }\r\n    set urlData(data) {\r\n        this.state.urlData = data;\r\n    }\r\n    updatePaginator(params) {\r\n        this.state.paginator = Object.assign(Object.assign({}, this.state.paginator), params);\r\n    }\r\n    set data(data) {\r\n        this.state.data = data;\r\n    }\r\n    get hasError() {\r\n        return !!this.state.error;\r\n    }\r\n    get errorMessage() {\r\n        return this.state.error;\r\n    }\r\n    get sortBy() {\r\n        return this.state.sortBy;\r\n    }\r\n    get sortDir() {\r\n        return this.state.sortDir;\r\n    }\r\n    setSuccess(data, pagination) {\r\n        this.data = data;\r\n        this.state.error = undefined;\r\n        this.state.errors = undefined;\r\n        this.updatePaginator(pagination);\r\n    }\r\n    setError(error, errors = {}, resetData = false) {\r\n        if (resetData) {\r\n            this.data = [];\r\n        }\r\n        this.state.error = error;\r\n        this.state.errors = errors;\r\n    }\r\n    setSort(field, direction) {\r\n        this.state.sortBy = field;\r\n        this.state.sortDir = direction;\r\n    }\r\n    setFormData(formId, data) {\r\n        this.state.formData[formId] = data;\r\n    }\r\n    getFilter() {\r\n        const forms = Object.keys(this.state.formData).reduce((prev, key) => {\r\n            return Object.assign(Object.assign({}, prev), this.state.formData[key]);\r\n        }, {});\r\n        return Object.assign(Object.assign({}, this.state.urlData), forms);\r\n    }\r\n}\r\n","import sf from '@spiral-toolkit/core';\r\n// import * as assert from 'assert';\r\nimport { DEFAULT_LIMIT } from './DatagridState';\r\n// import './styles.css';\r\nexport var PaginatorType;\r\n(function (PaginatorType) {\r\n    PaginatorType[\"pages\"] = \"pages\";\r\n    PaginatorType[\"infinite\"] = \"infinite\";\r\n})(PaginatorType || (PaginatorType = {}));\r\nexport class Paginator extends sf.core.BaseDOMConstructor {\r\n    constructor(sf, node, options) {\r\n        super();\r\n        this.optionsToGrab = {\r\n            id: {\r\n                value: Paginator.defaultOptions.id,\r\n                domAttr: 'id',\r\n            },\r\n            type: {\r\n                value: Paginator.defaultOptions.type,\r\n                domAttr: 'data-type',\r\n            },\r\n            fetchCount: {\r\n                value: Paginator.defaultOptions.fetchCount,\r\n                domAttr: 'data-fetch-count',\r\n            },\r\n            fetchCountOnce: {\r\n                value: Paginator.defaultOptions.fetchCountOnce,\r\n                domAttr: 'data-fetch-count-once',\r\n            }\r\n        };\r\n        this.options = Object.assign({}, Paginator.defaultOptions);\r\n        this.state = {\r\n            fetching: false,\r\n            limit: DEFAULT_LIMIT,\r\n        };\r\n        this.init(sf, node, options);\r\n        this.options = Object.assign(Object.assign({}, Paginator.defaultOptions), this.options);\r\n        this.render();\r\n    }\r\n    unlock() {\r\n        if (!this.options.lockType || this.options.lockType === 'none') {\r\n            return;\r\n        }\r\n        if (!this.sf.removeInstance('lock', this.node)) {\r\n            console.warn('You try to remove \\'lock\\' instance, but it is not available or not started');\r\n        }\r\n        return;\r\n    }\r\n    lock() {\r\n        if (!this.options.lockType || this.options.lockType === 'none') {\r\n            return;\r\n        }\r\n        const lock = this.sf.addInstance('lock', this.node, { type: this.options.lockType });\r\n        if (!lock) {\r\n            console.warn('You try to add \\'lock\\' instance, but it is not available or already started');\r\n            return;\r\n        }\r\n    }\r\n    setParams(params) {\r\n        this.state = Object.assign(Object.assign({}, this.state), params);\r\n        this.render();\r\n    }\r\n    hasPages() {\r\n        return typeof this.state.page !== 'undefined' && typeof this.state.limit !== 'undefined';\r\n    }\r\n    hasTotal() {\r\n        return typeof this.state.count !== 'undefined';\r\n    }\r\n    hasLimitOptions() {\r\n        return typeof this.options.limitOptions !== 'undefined';\r\n    }\r\n    generatePageList() {\r\n        const extendCurrent = 1;\r\n        const page = this.state.page;\r\n        const pagesCount = this.hasTotal() ? Math.ceil(this.state.count / this.state.limit) : page;\r\n        const hasNext = this.hasTotal() ? (page < pagesCount) : true;\r\n        const hasPrevious = page > 1;\r\n        const currentRange = [Math.max(page - extendCurrent, 1), Math.min(page + extendCurrent, pagesCount)];\r\n        const startRange = [1, Math.min(extendCurrent + 1, pagesCount)];\r\n        const endRange = [Math.max(pagesCount - extendCurrent, 1), pagesCount];\r\n        const pages = [];\r\n        let i = 1;\r\n        do {\r\n            pages.push({\r\n                page: i,\r\n                text: `${i}`,\r\n                active: page === i,\r\n            });\r\n            if (i >= startRange[1]) {\r\n                // we reached last page for start range\r\n                if (i + 1 < currentRange[0]) {\r\n                    // If page is more than 1 page further from next page in range, add ellipsis and jump\r\n                    pages.push({\r\n                        page: undefined,\r\n                        text: `...`,\r\n                        active: false,\r\n                    });\r\n                    // eslint-disable-next-line prefer-destructuring\r\n                    i = currentRange[0];\r\n                    // eslint-disable-next-line no-continue\r\n                    continue;\r\n                }\r\n            }\r\n            if (i >= currentRange[1]) {\r\n                // we reached last page for current page range\r\n                if (i + 1 < endRange[0]) {\r\n                    // If page is more than 1 page further from next page in range, add ellipsis and jump\r\n                    pages.push({\r\n                        page: undefined,\r\n                        text: `...`,\r\n                        active: false,\r\n                    });\r\n                    // eslint-disable-next-line prefer-destructuring\r\n                    i = endRange[0];\r\n                    // eslint-disable-next-line no-continue\r\n                    continue;\r\n                }\r\n            }\r\n            i += 1;\r\n        } while (i <= pagesCount);\r\n        return {\r\n            pages,\r\n            hasNext,\r\n            hasPrevious,\r\n        };\r\n    }\r\n    setLimit(limit) {\r\n        this.state.limit = limit;\r\n        this.options.onPageChange ? this.options.onPageChange(this.state) : 1;\r\n        this.render();\r\n    }\r\n    setPage(page) {\r\n        this.state.page = page;\r\n        this.options.onPageChange ? this.options.onPageChange(this.state) : 1;\r\n        this.render();\r\n    }\r\n    render() {\r\n        const counterDiv = document.createElement('div');\r\n        counterDiv.className = 'col-12 col-lg-4';\r\n        if (this.hasPages()) {\r\n            if (this.hasTotal()) {\r\n                counterDiv.innerHTML = `Showing ${(this.state.page - 1) * this.state.limit + 1} to ${this.state.page * this.state.limit} of ${this.state.count} entries`;\r\n            }\r\n            else {\r\n                counterDiv.innerHTML = `Showing ${(this.state.page - 1) * this.state.limit + 1} to ${this.state.page * this.state.limit} entries`;\r\n            }\r\n        }\r\n        const limitDiv = document.createElement('div');\r\n        limitDiv.className = 'col-4 col-md-2 col-lg-2';\r\n        if (this.hasLimitOptions()) {\r\n            limitDiv.innerHTML = `<div class=\"form-group row mb-0\">\n                    <label class=\"col-form-label-sm col-auto\">Show</label>\n                    <select name=\"limit\" class=\"custom-select custom-select-sm col-6\">\n                    </select>\n                  </div>`;\r\n            const select = limitDiv.querySelector('select');\r\n            this.options.limitOptions.forEach((opt) => {\r\n                const option = document.createElement('option');\r\n                option.value = `${opt}`;\r\n                option.innerHTML = `${opt}`;\r\n                if (opt === this.state.limit) {\r\n                    option.setAttribute('checked', 'checked');\r\n                }\r\n                select.appendChild(option);\r\n            });\r\n            select.value = `${this.state.limit}`;\r\n            select.addEventListener('change', (e) => {\r\n                this.setLimit(+select.value);\r\n            });\r\n        }\r\n        else {\r\n        }\r\n        const pagesDiv = document.createElement('div');\r\n        pagesDiv.className = 'col-8 col-md-10 col-lg-6';\r\n        if (this.hasPages()) {\r\n            pagesDiv.innerHTML = `<ul class=\"pagination pagination-sm justify-content-end mb-0\">`;\r\n            const ul = pagesDiv.querySelector('ul');\r\n            const pageInfo = this.generatePageList();\r\n            {\r\n                const li = document.createElement('li');\r\n                li.className = pageInfo.hasPrevious ? 'page-item previous' : 'page-item previous disabled';\r\n                if (pageInfo.hasPrevious) {\r\n                    li.addEventListener('click', () => this.setPage(this.state.page - 1));\r\n                }\r\n                li.innerHTML = `<a href=\"#\" tabindex=\"0\" class=\"page-link\"></a>`;\r\n                ul.appendChild(li);\r\n            }\r\n            pageInfo.pages.forEach((p) => {\r\n                const li = document.createElement('li');\r\n                li.className = p.active ? 'page-item active' : 'page-item';\r\n                if (p.page) {\r\n                    li.addEventListener('click', () => this.setPage(p.page));\r\n                    li.innerHTML = `<a href=\"#\" tabindex=\"0\" class=\"page-link\">${p.text}</a>`;\r\n                }\r\n                else {\r\n                    li.innerHTML = `<a tabindex=\"0\" class=\"page-link\">${p.text}</a>`;\r\n                }\r\n                ul.appendChild(li);\r\n            });\r\n            {\r\n                const li = document.createElement('li');\r\n                li.className = pageInfo.hasNext ? 'page-item next' : 'page-item next disabled';\r\n                if (pageInfo.hasNext) {\r\n                    li.addEventListener('click', () => this.setPage(this.state.page + 1));\r\n                }\r\n                li.innerHTML = `<a href=\"#\" tabindex=\"0\" class=\"page-link\"></a>`;\r\n                ul.appendChild(li);\r\n            }\r\n        }\r\n        if (!this.el) {\r\n            this.el = document.createElement('div');\r\n            this.node.appendChild(this.el);\r\n        }\r\n        else {\r\n            this.el.innerHTML = ''; // TODO: dont rerender\r\n        }\r\n        const el = this.el;\r\n        el.className = this.options.className || '';\r\n        el.appendChild(counterDiv);\r\n        el.appendChild(limitDiv);\r\n        el.appendChild(pagesDiv);\r\n    }\r\n}\r\nPaginator.spiralFrameworkName = 'datagrid-paginator';\r\nPaginator.defaultOptions = {\r\n    id: '',\r\n    lockType: 'none',\r\n    fetchCount: true,\r\n    fetchCountOnce: true,\r\n    type: PaginatorType.pages,\r\n    className: 'row no-gutters align-items-center m-3',\r\n    limitOptions: [10, 25, 50, 100],\r\n};\r\nexport default Paginator;\r\n","export const defaultRenderer = {\r\n    columns: [],\r\n    sortable: [],\r\n    /**\r\n     * Basic class/attribute properties\r\n     */\r\n    ui: {\r\n        wrapperClassName: 'table-responsive',\r\n        tableClassName: 'table table-striped',\r\n        cellClassName: {},\r\n        rowClassName: '',\r\n        cellAttributes: cellMeta => {\r\n            return {};\r\n        },\r\n        rowAttributes: rowlMeta => {\r\n            return {};\r\n        }\r\n    },\r\n};\r\n","import { SortDirection } from './constants';\r\nexport const normalizeColumns = (columns, sortable) => {\r\n    const sList = sortable.map((s) => {\r\n        if (typeof s === 'string') {\r\n            return { field: s, direction: undefined };\r\n        }\r\n        return s;\r\n    });\r\n    return columns.map((c) => {\r\n        let id;\r\n        let title;\r\n        let sortDir;\r\n        if (typeof c === 'string') {\r\n            id = c;\r\n            title = c;\r\n            sortDir = SortDirection.ASC;\r\n        }\r\n        else {\r\n            id = c.id;\r\n            title = c.title || c.id;\r\n            sortDir = c.sortDir || SortDirection.ASC;\r\n        }\r\n        const sort = sList.find((s) => (s.field === id));\r\n        if (sort) {\r\n            return {\r\n                id,\r\n                title,\r\n                sortable: true,\r\n                direction: sort.direction || sortDir,\r\n            };\r\n        }\r\n        return {\r\n            id,\r\n            title,\r\n            sortable: false,\r\n            direction: SortDirection.ASC,\r\n        };\r\n    });\r\n};\r\nexport const applyAttrributes = (node, attrs) => {\r\n    Object.keys(attrs).forEach((name) => {\r\n        node.setAttribute(name, attrs[name]);\r\n    });\r\n};\r\n","export const defaultBodyWrapper = (node, options, state) => {\r\n    const el = document.createElement('tbody');\r\n    node.appendChild(el);\r\n    if (state.hasError) {\r\n        const errorTr = document.createElement('tr');\r\n        const errorTd = document.createElement('td');\r\n        errorTd.colSpan = options.columns.length;\r\n        errorTd.innerText = state.errorMessage || 'Unknown Error';\r\n        errorTd.classList.add('sf-table__error');\r\n        errorTr.appendChild(errorTd);\r\n        el.appendChild(errorTr);\r\n    }\r\n    else if (state.data.length === 0) {\r\n        const emptyTr = document.createElement('tr');\r\n        const emptyTd = document.createElement('td');\r\n        emptyTd.colSpan = options.columns.length;\r\n        emptyTd.innerHTML = 'No Data';\r\n        emptyTd.classList.add('sf-table__empty');\r\n        emptyTr.appendChild(emptyTd);\r\n        el.appendChild(emptyTr);\r\n    }\r\n    return el;\r\n};\r\n","export const defaultFooterWrapper = (node, options, state) => {\r\n    return undefined;\r\n};\r\n","import { SortDirection } from '../constants';\r\nexport const defaultHeaderCellRenderer = (column, options, state) => {\r\n    const el = document.createElement('th');\r\n    const classes = [];\r\n    if (column.sortable) {\r\n        classes.push('sf-table__sort');\r\n        el.addEventListener('click', () => {\r\n            state.parent.triggerSort(column.id);\r\n        });\r\n    }\r\n    if (state.sortBy === column.id) {\r\n        if (state.sortDir === SortDirection.ASC) {\r\n            classes.push('sf-table__sort_asc');\r\n        }\r\n        else {\r\n            classes.push('sf-table__sort_desc');\r\n        }\r\n    }\r\n    el.innerHTML = `<div class=\"${classes.join(' ')}\">${column.title}</div>`;\r\n    return el;\r\n};\r\n","export const defaultHeaderWrapper = (node, options, state) => {\r\n    const el = document.createElement('thead');\r\n    node.appendChild(el);\r\n    const tr = document.createElement('tr');\r\n    el.appendChild(tr);\r\n    return el;\r\n};\r\n","export const defaultRowCellRenderer = (column, options, state, index) => {\r\n    const el = document.createElement('td');\r\n    el.innerText = state.data[index][column.id];\r\n    return el;\r\n};\r\n","export const defaultRowWrapper = (node, options, state, index) => {\r\n    const el = document.createElement('tr');\r\n    node.appendChild(el);\r\n    return el;\r\n};\r\n","export const defaultTableWrapper = (node, options) => {\r\n    const el = document.createElement('table');\r\n    el.className = options.ui.tableClassName || '';\r\n    node.appendChild(el);\r\n    return el;\r\n};\r\n","import { applyAttrributes, normalizeColumns } from '../utils';\r\nimport { defaultBodyWrapper } from './defaultBodyWrapper';\r\nimport { defaultFooterWrapper } from './defaultFooterWrapper';\r\nimport { defaultHeaderCellRenderer } from './defaultHeaderCellRenderer';\r\nimport { defaultHeaderWrapper } from './defaultHeaderWrapper';\r\nimport { defaultRowCellRenderer } from './defaultRowRenderer';\r\nimport { defaultRowWrapper } from './defaultRowWrapper';\r\nimport { defaultTableWrapper } from './defaultTableWrapper';\r\nexport class GridRenderer {\r\n    constructor(options, root) {\r\n        this.options = options;\r\n        this.root = root;\r\n        this.columnInfo = normalizeColumns(this.options.columns, this.options.sortable);\r\n        console.log(this.columnInfo);\r\n        this.create();\r\n    }\r\n    create() {\r\n        this.wrapper = document.createElement('div');\r\n        this.wrapper.setAttribute('role', 'sf-datagrid-wrapper');\r\n        this.wrapper.setAttribute('class', this.options.ui.wrapperClassName || '');\r\n        this.root.node.innerHTML = '';\r\n        this.root.node.appendChild(this.wrapper);\r\n        const tableRenderer = this.options.tableWrapper || defaultTableWrapper;\r\n        this.tableEl = tableRenderer(this.wrapper, this.options);\r\n    }\r\n    applyAdditionalCellAttributes(el, column, options, state, index) {\r\n        const cellMeta = {\r\n            id: column.id,\r\n            column: column,\r\n            index,\r\n            // rowSelected: (state as any).isSelected(index),\r\n            rowSelected: false,\r\n            state: state,\r\n            item: state.data[index],\r\n        };\r\n        if (options.ui.cellClassName) {\r\n            if (typeof options.ui.cellClassName === 'function') {\r\n                el.classList.add(options.ui.cellClassName(cellMeta));\r\n            }\r\n            else {\r\n                const specific = options.ui.cellClassName[column.id];\r\n                if (specific) {\r\n                    if (typeof specific === 'string') {\r\n                        el.classList.add(specific);\r\n                    }\r\n                    else {\r\n                        el.classList.add(specific(cellMeta));\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (options.ui.cellAttributes) {\r\n            if (typeof options.ui.cellAttributes === 'function') {\r\n                applyAttrributes(el, options.ui.cellAttributes(cellMeta));\r\n            }\r\n            else {\r\n                const specific = options.ui.cellAttributes[column.id];\r\n                if (specific) {\r\n                    if (typeof specific === 'function') {\r\n                        applyAttrributes(el, specific(cellMeta));\r\n                    }\r\n                    else {\r\n                        applyAttrributes(el, specific);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    applyAdditionalHeaderCellAttributes(el, column, options, state) {\r\n        const cellMeta = {\r\n            id: column.id,\r\n            column: column,\r\n            index: 0,\r\n            rowSelected: false,\r\n            state: state,\r\n            item: null,\r\n        };\r\n        if (options.ui.headerCellClassName) {\r\n            if (typeof options.ui.headerCellClassName === 'function') {\r\n                el.classList.add(options.ui.headerCellClassName(cellMeta));\r\n            }\r\n            else {\r\n                const specific = options.ui.headerCellClassName[column.id];\r\n                if (specific) {\r\n                    if (typeof specific === 'string') {\r\n                        el.classList.add(specific);\r\n                    }\r\n                    else {\r\n                        el.classList.add(specific(cellMeta));\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (options.ui.headerCellAttributes) {\r\n            if (typeof options.ui.headerCellAttributes === 'function') {\r\n                applyAttrributes(el, options.ui.headerCellAttributes(cellMeta));\r\n            }\r\n            else {\r\n                const specific = options.ui.headerCellAttributes[column.id];\r\n                if (specific) {\r\n                    if (typeof specific === 'function') {\r\n                        applyAttrributes(el, specific(cellMeta));\r\n                    }\r\n                    else {\r\n                        applyAttrributes(el, specific);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    render(state) {\r\n        // Render header\r\n        const headerRenderer = this.options.headerWrapper || defaultHeaderWrapper;\r\n        if (this.headerEl) {\r\n            this.tableEl.removeChild(this.headerEl);\r\n        }\r\n        this.headerEl = headerRenderer(this.tableEl, this.options, state);\r\n        if (this.headerEl) {\r\n            this.tableEl.appendChild(this.headerEl);\r\n            if (this.columnInfo.length) {\r\n                this.columnInfo.forEach((cI, index) => {\r\n                    const headerCellRenderer = (this.options.headerList || {})[cI.id] || defaultHeaderCellRenderer;\r\n                    const node = headerCellRenderer(cI, this.options, state);\r\n                    this.applyAdditionalHeaderCellAttributes(node, cI, this.options, state);\r\n                    this.headerEl.appendChild(node);\r\n                });\r\n            }\r\n        }\r\n        // Render body\r\n        if (this.bodyEl) {\r\n            this.tableEl.removeChild(this.bodyEl);\r\n        }\r\n        const bodyRenderer = this.options.bodyWrapper || defaultBodyWrapper;\r\n        this.bodyEl = bodyRenderer(this.tableEl, this.options, state);\r\n        if (this.bodyEl) {\r\n            this.tableEl.appendChild(this.bodyEl);\r\n            const row = this.options.rowWrapper || defaultRowWrapper;\r\n            state.data.forEach((item, index) => {\r\n                const el = row(this.bodyEl, this.options, state, index);\r\n                this.columnInfo.forEach((cI) => {\r\n                    const rowCellRenderer = (this.options.cells || {})[cI.id] || defaultRowCellRenderer;\r\n                    const node = rowCellRenderer(cI, this.options, state, index);\r\n                    this.applyAdditionalCellAttributes(node, cI, this.options, state, index);\r\n                    el.appendChild(node);\r\n                });\r\n            });\r\n        }\r\n        // Render footer\r\n        if (this.footerEl) {\r\n            this.tableEl.removeChild(this.footerEl);\r\n        }\r\n        const footerRenderer = this.options.footerWrapper || defaultFooterWrapper;\r\n        this.footerEl = footerRenderer(this.tableEl, this.options, state);\r\n        if (this.footerEl) {\r\n            this.tableEl.appendChild(this.footerEl);\r\n            // We assume footer render handles all data so no additional renders here\r\n        }\r\n    }\r\n}\r\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n};\r\nimport sf from '@spiral-toolkit/core';\r\nimport * as assert from 'assert';\r\nimport { pageParams, RequestMethod, SortDirection, sortParams } from './constants';\r\nimport { DatagridState, DEFAULT_LIMIT } from './DatagridState';\r\nimport Paginator from './Paginator';\r\nimport { defaultRenderer } from './render/defaultRenderer';\r\nimport { GridRenderer } from './render/GridRenderer';\r\nimport { normalizeColumns } from './utils';\r\nimport { parse, stringifyUrl } from 'query-string';\r\n// import './styles.css';\r\nexport class Datagrid extends sf.core.BaseDOMConstructor {\r\n    constructor(sf, node, options) {\r\n        super();\r\n        this.optionsToGrab = {\r\n            id: {\r\n                value: Datagrid.defaultOptions.id,\r\n                domAttr: 'id',\r\n            },\r\n            url: {\r\n                value: Datagrid.defaultOptions.url,\r\n                domAttr: 'data-url',\r\n            }\r\n        };\r\n        this.options = Object.assign({}, Datagrid.defaultOptions);\r\n        this.grids = [];\r\n        this.state = new DatagridState(this);\r\n        this.capturedForms = []; // TODO: type as sf.Form instance array\r\n        this.capturedPaginators = []; // TODO: type as sf.Paginator instance array\r\n        this.defaults = {\r\n            page: 1,\r\n            limit: DEFAULT_LIMIT,\r\n        };\r\n        this.init(sf, node, options);\r\n        this.options = Object.assign(Object.assign({}, Datagrid.defaultOptions), this.options);\r\n        const additionalOptionsEl = node.querySelector('script[role=\"sf-options\"]');\r\n        if (additionalOptionsEl) {\r\n            try {\r\n                const one = Function('\"use strict\";return ' + additionalOptionsEl.innerHTML.trim() + '');\r\n                // console.log('\"use strict\";return ' + additionalOptionsEl.innerHTML.trim() + '');\r\n                const overrides = one()();\r\n                this.options = Object.assign(Object.assign({}, this.options), overrides);\r\n            }\r\n            catch (e) {\r\n                console.error('Could not parse options inside script, ensure script inside is an anonymous function returning IDataGridOptions object');\r\n                throw e;\r\n            }\r\n        }\r\n        assert.notEqual(this.options.id, '', 'id should be not empty');\r\n        assert.notEqual(this.options.url, '', 'url should be not empty');\r\n        // Process options\r\n        // TODO: we can override columns and sort options inside renderers but it might produce situation of triggering unexisting sort\r\n        // Think about that, or ignore\r\n        this.columnInfo = normalizeColumns(this.options.columns, this.options.sortable);\r\n        // Set default sort if present\r\n        if (this.options.sort) {\r\n            if (typeof this.options.sort === 'string') {\r\n                this.defaults.sortBy = this.options.sort;\r\n                this.defaults.sortDir = SortDirection.ASC;\r\n            }\r\n            else {\r\n                this.defaults.sortBy = this.options.sort.field;\r\n                this.defaults.sortDir = this.options.sort.direction || SortDirection.ASC;\r\n            }\r\n            this.state.setSort(this.defaults.sortBy, this.defaults.sortDir);\r\n        }\r\n        this.createRenderers();\r\n        this.initFromUrl();\r\n        this.captureForms();\r\n        this.request();\r\n    }\r\n    registerFormInstance(formInstance) {\r\n        if (formInstance.options && formInstance.options.id && this.options.captureForms.indexOf(formInstance.options.url) >= 0) {\r\n            this.capturedForms.push(formInstance);\r\n            formInstance.options.jsonOnly = true;\r\n            formInstance.options.beforeSubmitCallback = (options) => {\r\n                this.resetPaginator();\r\n                this.state.setFormData(formInstance.options.id, options.data);\r\n                this.request(); // TODO: better way\r\n                return false;\r\n            };\r\n        }\r\n    }\r\n    registerPaginatorInstance(formInstance) {\r\n        if (formInstance.options && formInstance.options.id && this.options.captureForms.indexOf(formInstance.options.id) >= 0) {\r\n            this.capturedPaginators.push(formInstance);\r\n            formInstance.options.onPageChange = (options) => {\r\n                this.state.updatePaginator(options);\r\n                this.request(); // TODO: better way\r\n                return false;\r\n            };\r\n        }\r\n    }\r\n    captureForms() {\r\n        const forms = this.sf.getInstances('form') || [];\r\n        forms.forEach((f) => {\r\n            this.registerFormInstance(f.instance);\r\n        });\r\n        const paginators = this.sf.getInstances(Paginator.spiralFrameworkName) || [];\r\n        paginators.forEach((f) => {\r\n            this.registerFormInstance(f.instance);\r\n        });\r\n        this.sf.instancesController.events.on('onAddInstance', ({ instance, type }) => {\r\n            if (type === 'form') {\r\n                this.registerFormInstance(instance);\r\n            }\r\n            if (type === Paginator.spiralFrameworkName) {\r\n                this.registerPaginatorInstance(instance);\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * Sets sort for this field if not yet, or changes direction if already same\r\n     * @param fieldId\r\n     */\r\n    triggerSort(fieldId) {\r\n        if (this.state.sortBy === fieldId) {\r\n            if (this.state.sortDir === SortDirection.ASC) {\r\n                this.state.setSort(fieldId, SortDirection.DESC);\r\n            }\r\n            else {\r\n                this.state.setSort(fieldId, SortDirection.ASC);\r\n            }\r\n        }\r\n        else {\r\n            const field = this.columnInfo.find(cI => cI.id === fieldId);\r\n            if (field) {\r\n                this.state.setSort(field.id, field.direction);\r\n            }\r\n            else {\r\n                console.warn(`Trying to sort by unsortable field ${fieldId}`);\r\n            }\r\n        }\r\n        this.resetPaginator();\r\n        this.request();\r\n    }\r\n    resetPaginator() {\r\n        // TODO: depending on paginator type perform different reset type\r\n        this.state.updatePaginator({ page: 1 });\r\n        this.capturedPaginators.forEach((f) => {\r\n            if (f.setParams) {\r\n                f.setParams(this.state.paginate);\r\n            }\r\n        });\r\n    }\r\n    formRequest() {\r\n        const request = {\r\n            fetchCount: true,\r\n            filter: this.state.getFilter(),\r\n            paginate: this.state.paginate,\r\n            sort: this.state.sortBy ? { [this.state.sortBy]: this.state.sortDir } : {}\r\n        };\r\n        return request;\r\n    }\r\n    unlock() {\r\n        if (!this.sf.removeInstance('lock', this.node)) {\r\n            console.warn('You try to remove \\'lock\\' instance, but it is not available or not started');\r\n        }\r\n        this.capturedForms.forEach((f) => {\r\n            if (f.unlock) {\r\n                f.unlock();\r\n            }\r\n        });\r\n        this.capturedPaginators.forEach((f) => {\r\n            if (f.unlock) {\r\n                f.unlock();\r\n            }\r\n        });\r\n        return;\r\n    }\r\n    lock() {\r\n        if (!this.options.lockType || this.options.lockType === 'none') {\r\n            return;\r\n        }\r\n        const lock = this.sf.addInstance('lock', this.node, { type: this.options.lockType });\r\n        if (!lock) {\r\n            console.warn('You try to add \\'lock\\' instance, but it is not available or already started');\r\n            return;\r\n        }\r\n        this.capturedForms.forEach((f) => {\r\n            if (f.lock) {\r\n                f.lock();\r\n            }\r\n        });\r\n        this.capturedPaginators.forEach((f) => {\r\n            if (f.lock) {\r\n                f.lock();\r\n            }\r\n        });\r\n    }\r\n    handleSuccess({ data }) {\r\n        this.state.setSuccess(data.data, data.pagination);\r\n        this.render();\r\n        this.capturedPaginators.forEach((f) => {\r\n            if (f.setParams) {\r\n                f.setParams(this.state.paginate);\r\n            }\r\n        });\r\n    }\r\n    beforeSubmit() {\r\n        this.capturedForms.forEach((f) => {\r\n            if (f.removeMessages) {\r\n                f.removeMessages();\r\n            }\r\n        });\r\n    }\r\n    handleError({ data, status, statusText }) {\r\n        this.state.setError(data.error, data.errors, this.options.resetOnError);\r\n        this.capturedForms.forEach((f) => {\r\n            if (f.processAnswer) {\r\n                f.processAnswer({ data, status, statusText }, false); // false stands for 'dont display errors unrelated to form inputs'\r\n            }\r\n        });\r\n        this.capturedPaginators.forEach((f) => {\r\n            if (f.processAnswer) {\r\n                f.processAnswer({ data, status, statusText }); // TODO: might be different API\r\n            }\r\n        });\r\n        this.render();\r\n        // TODO: remove data and display error\r\n        // TODO: send validation errors to other forms\r\n    }\r\n    request() {\r\n        return __awaiter(this, void 0, void 0, function* () {\r\n            if (this.state.isLoading) {\r\n                console.warn('Cant start new request');\r\n                return;\r\n            }\r\n            this.state.startLoading();\r\n            this.beforeSubmit();\r\n            this.lock();\r\n            this.updateUrl();\r\n            const data = this.formRequest();\r\n            const request = this.sf.ajax.send({\r\n                url: this.options.url,\r\n                method: this.options.method,\r\n                headers: this.options.headers,\r\n                data,\r\n            });\r\n            try {\r\n                const response = yield request;\r\n                this.handleSuccess(response);\r\n            }\r\n            catch (e) {\r\n                if (e.isSFAjaxError) {\r\n                    this.handleError(e);\r\n                }\r\n                else {\r\n                    this.handleError({\r\n                        data: {\r\n                            error: e.toString(),\r\n                            originalError: e,\r\n                        },\r\n                        status: 1000,\r\n                        statusText: e.toString(),\r\n                    });\r\n                }\r\n            }\r\n            finally {\r\n                this.unlock();\r\n                this.state.stopLoading();\r\n            }\r\n        });\r\n    }\r\n    createRenderers() {\r\n        assert.deepEqual(this.grids, [], 'Grids are already initialized');\r\n        const renderList = Array.isArray(this.options.renderers) ? this.options.renderers : [this.options.renderers];\r\n        renderList.forEach((renderOption) => {\r\n            this.grids.push(new GridRenderer(Object.assign(Object.assign({}, renderOption), { columns: (renderOption.columns && renderOption.columns.length) ? renderOption.columns : this.options.columns, sortable: (renderOption.sortable && renderOption.sortable.length) ? renderOption.sortable : this.options.sortable }), this));\r\n        });\r\n    }\r\n    render() {\r\n        this.grids.forEach((grid) => {\r\n            grid.render(this.state);\r\n        });\r\n    }\r\n    serialize() {\r\n        const custom = this.state.getFilter();\r\n        const pagination = this.state.paginate;\r\n        const sortOptions = this.state.sortBy ? { sortBy: this.state.sortBy, sortDir: this.state.sortDir } : {};\r\n        return Object.assign(Object.assign(Object.assign({}, custom), pagination), sortOptions);\r\n    }\r\n    deserialize(values) {\r\n        const { page, limit, cid, lid } = values;\r\n        this.state.updatePaginator({ page: +page, limit: +limit, cid, lid }); // TODO: skip invalid page/limit values\r\n        const { sortBy, sortDir } = values;\r\n        if (sortBy) {\r\n            this.state.setSort(sortBy, sortDir || SortDirection.ASC); // TODO: skip\r\n        }\r\n        [...pageParams, ...sortParams].forEach((p) => delete values[p]);\r\n        this.state.urlData = values;\r\n    }\r\n    initFromUrl() {\r\n        if (this.options.serialize) {\r\n            if (window.location.search) {\r\n                const urlData = this.getObjectFromUrl(typeof this.options.serialize === 'string' ? this.options.serialize : '');\r\n                if (Object.keys(urlData).length) {\r\n                    this.deserialize(urlData);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    updateUrl() {\r\n        if (this.options.serialize) {\r\n            const data = this.serialize();\r\n            this.putObjectToUrl(data, typeof this.options.serialize === 'string' ? this.options.serialize : '');\r\n        }\r\n    }\r\n    getObjectFromUrl(defaults, prefix = '') {\r\n        const obj = parse(window.location.search);\r\n        const result = Object.keys(obj).reduce((map, oK) => {\r\n            if (!prefix || oK.indexOf(prefix) === 0) {\r\n                return Object.assign(Object.assign({}, map), { [oK.substr(prefix.length)]: (typeof obj[oK] !== 'undefined') ? obj[oK] : defaults[oK.substr(prefix.length)] });\r\n            }\r\n            return map;\r\n        }, {});\r\n        return result;\r\n    }\r\n    putObjectToUrl(obj, defaults, prefix = '') {\r\n        if (!window.history) {\r\n            console.warn('Cant update URL without reload, skipping');\r\n            return;\r\n        }\r\n        const query = Object.keys(obj).reduce((map, oK) => {\r\n            if (obj[oK] && obj[oK] != defaults[oK]) {\r\n                return Object.assign(Object.assign({}, map), { [`${prefix}${oK}`]: obj[oK] });\r\n            }\r\n            return map;\r\n        }, {});\r\n        history.pushState({}, document.title, stringifyUrl({ url: window.location.href, query }));\r\n    }\r\n}\r\nDatagrid.spiralFrameworkName = 'datagrid';\r\nDatagrid.defaultOptions = {\r\n    id: '',\r\n    lockType: 'default',\r\n    resetOnError: false,\r\n    captureForms: [],\r\n    columns: [],\r\n    headers: {},\r\n    method: RequestMethod.POST,\r\n    sortable: [],\r\n    url: '',\r\n    serialize: true,\r\n    ui: {\r\n        cellAttributes: {},\r\n        rowAttributes: {},\r\n        rowClassName: '',\r\n        cellClassName: {},\r\n        tableClassName: 'table table-stripped',\r\n        wrapperClassName: 'table-responsive'\r\n    },\r\n    renderers: defaultRenderer,\r\n};\r\nexport default Datagrid;\r\n","export const simpleCellFormatter = (formatFunction = (v) => (v ? v.toString() : ''), tagName = 'td') => {\r\n    const renderer = (column, options, state, index) => {\r\n        const el = document.createElement(tagName);\r\n        el.innerHTML = formatFunction(state.data[index][column.id], state.data[index]);\r\n        return el;\r\n    };\r\n    return renderer;\r\n};\r\n","import sf from '@spiral-toolkit/core';\r\nimport DataGrid from './Datagrid';\r\nimport Paginator from './Paginator';\r\nimport { simpleCellFormatter } from './render/premade/simpleCellFormatter';\r\nexport const renders = {\r\n    simpleCellFormatter,\r\n};\r\nwindow.SFDatagridTools = renders; // TODO: How to export that properly?\r\nsf.registerInstanceType(DataGrid, 'sf-js-datagrid');\r\nsf.registerInstanceType(Paginator, 'sf-js-datagrid-paginator');\r\nexport default DataGrid; // ES6 default export will not expose us as global\r\n","const core = require('@spiral-toolkit/core');\n\nrequire('./input');\n\nrequire('@spiral-toolkit/locker');\nrequire('@spiral-toolkit/form');\nrequire('@spiral-toolkit/datagrid');\n\n\nmodule.exports = core;\n"],"sourceRoot":""}